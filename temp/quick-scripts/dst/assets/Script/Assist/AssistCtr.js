
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/Assist/AssistCtr.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '67573FQFuJC4rHah/hjaHuj', 'AssistCtr');
// Script/Assist/AssistCtr.ts

"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AssistCtr = void 0;
var AdPosition_1 = require("../common/AdPosition");
var NameTs_1 = require("../common/NameTs");
var PropConst_1 = require("../common/PropConst");
var AdController_1 = require("../server/xmsdk_cocos/AD/AdController");
var AdUtil_1 = require("../server/xmsdk_cocos/AD/AdUtil");
var AppInfo_1 = require("../server/xmsdk_cocos/Config/AppInfo");
var util_1 = require("../util/util");
exports.AssistCtr = {
    cloneObject: function (obj) {
        var cache = [];
        var str = JSON.stringify(obj, function (key, value) {
            if (typeof value === 'object' && value !== null) {
                if (cache.indexOf(value) !== -1) {
                    // 移除
                    return;
                }
                // 收集所有的值
                cache.push(value);
            }
            return value;
        });
        cache = null; // 清空变量，便于垃圾回收机制回收
        return JSON.parse(str);
    },
    nodeToWorld: function (pos, node) {
        return node.convertToWorldSpaceAR(pos);
    },
    worldToNode: function (worldPos, node) {
        return node.convertToNodeSpaceAR(worldPos);
    },
    formatDate: function (date) {
        var date = new Date(date);
        var YY = date.getFullYear() + '-';
        var MM = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
        var DD = (date.getDate() < 10 ? '0' + (date.getDate()) : date.getDate());
        var hh = (date.getHours() < 10 ? '0' + date.getHours() : date.getHours()) + ':';
        var mm = (date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes()) + ':';
        var ss = (date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds());
        return YY + MM + DD + " " + hh + mm + ss;
    },
    /**
     *
     * @param value 秒
     */
    formatSeconds: function (value) {
        var result = parseInt(value);
        var h = Math.floor(result / 3600) < 10 ? '0' + Math.floor(result / 3600) : Math.floor(result / 3600);
        var m = Math.floor((result / 60 % 60)) < 10 ? '0' + Math.floor((result / 60 % 60)) : Math.floor((result / 60 % 60));
        var s = Math.floor((result % 60)) < 10 ? '0' + Math.floor((result % 60)) : Math.floor((result % 60));
        var res = '';
        //res += `${h}:`;
        res += m + ":";
        res += "" + s;
        return res;
    },
    //距离24点还有多久
    formatData24: function () {
        var date = new Date();
        var temphh = 23 - date.getHours();
        var tempMinutes = 59 - date.getMinutes();
        var tempSeconds = 59 - date.getSeconds();
        var hh = (temphh < 10 ? '0' + temphh : temphh) + ':';
        var mm = (tempMinutes < 10 ? '0' + tempMinutes : tempMinutes) + ':';
        var ss = (tempSeconds < 10 ? '0' + tempSeconds : tempSeconds);
        return hh + mm + ss;
    },
    convertNumber: function (num) {
        if (num === void 0) { num = 0; }
        if (typeof num != 'number') {
            num = Number(num);
        }
        if (isNaN(num)) {
            num = 0;
        }
        if (num >= 10000) {
            return (num / 10000).toFixed(1) + 'w';
        }
        else if (num >= 1000) {
            return (num / 1000).toFixed(1) + 'k';
        }
        return num;
    },
    findPropSprite: function (type, keyId, sucCall, errCall) {
        if (type == PropConst_1.REWARD_TYPE.PROPS) {
            if (PropConst_1.PROPS[keyId]) {
                cc.resources.load("ActivyResource/Image/Prop/" + PropConst_1.PROPS[keyId].icon, cc.SpriteFrame, function (err, spriteFrame) {
                    if (err) {
                        if (errCall)
                            errCall;
                    }
                    ;
                    if (sucCall)
                        sucCall(spriteFrame);
                });
            }
        }
        else {
            if (PropConst_1.POINT[keyId]) {
                cc.resources.load("ActivyResource/Image/Point/" + PropConst_1.POINT[keyId].name, cc.SpriteFrame, function (err, spriteFrame) {
                    if (err) {
                        if (errCall)
                            errCall;
                    }
                    ;
                    if (sucCall)
                        sucCall(spriteFrame);
                });
            }
        }
        return null;
    },
    removeEleFromArray: function (ele, arr) {
        var index = arr.indexOf(ele);
        if (index >= 0) {
            arr.splice(index, 1);
        }
        return arr;
    },
    hasEleInArray: function (ele, arr) {
        return arr.indexOf(ele) > -1;
    },
    findArrInArr: function (arr1, arr2) {
        var arr = [];
        for (var m in arr2) {
            if (arr2[m] && arr1.indexOf(arr2[m]) > -1) {
                arr.push(arr2[m]);
            }
        }
        return arr;
    },
    findArrNoArr: function (arr1, arr2) {
        var arr = [];
        for (var m in arr2) {
            if (arr2[m] && arr1.indexOf(arr2[m]) == -1) {
                arr.push(arr2[m]);
            }
        }
        return arr;
    },
    playAnimate: function (spriteFrame, startNode, target, callback) {
        var canvasNode = cc.director.getScene().getChildByName('Canvas');
        var startPos = canvasNode.convertToNodeSpaceAR(startNode.convertToWorldSpaceAR(cc.v2(0, 0)));
        var endPos = canvasNode.convertToNodeSpaceAR(target.convertToWorldSpaceAR(cc.v2(0, 0)));
        var node = new cc.Node();
        //node.setContentSize(136, 136);
        node.zIndex = 2001;
        node.setPosition(startPos);
        var sprite = node.addComponent(cc.Sprite);
        sprite.spriteFrame = spriteFrame;
        sprite.type = cc.Sprite.Type.SIMPLE;
        sprite.sizeMode = cc.Sprite.SizeMode.RAW;
        sprite.trim = false;
        node.scale = 1;
        node.parent = canvasNode;
        var actions = [];
        var midPos = cc.v2(startPos.x + 150, startPos.y - 150);
        var bezier = [startPos, midPos, endPos];
        var bezierTo = cc.bezierTo(0.5, bezier);
        var scaleTo = cc.scaleTo(0.5, 0.3, 0.3);
        actions.push(cc.delayTime(0.3));
        actions.push(cc.spawn(scaleTo, bezierTo));
        actions.push(cc.fadeOut(0.2));
        actions.push(cc.callFunc(function () {
            node.destroy();
            callback && callback(target);
        }));
        node.runAction(cc.sequence(actions));
    },
    showToastTip: function (msg) {
        var _this = this;
        if (this.isShowMsg)
            return;
        this.isShowMsg = true;
        setTimeout(function () {
            _this.isShowMsg = false;
        }, 1500);
        cc.director.emit(NameTs_1.default.Show_Toast, msg);
    },
    //检查插屏概率
    checkIsOpenInserAd: function (id, isLoad) {
        if (isLoad === void 0) { isLoad = true; }
        var random = Math.random();
        var isPlay = false;
        AdUtil_1.AdUtil.inserAdIsPlay["inserAd" + id] = true;
        if (id == AdPosition_1.AdPosition.SignAwardInsert) {
            if (id == AdPosition_1.AdPosition.SignAwardInsert && !util_1.default.userData.newUser) {
                if (random <= 0.5) {
                    isPlay = true;
                }
            }
        }
        AdUtil_1.AdUtil.inserAdIsPlay["inserAd" + id] = isPlay;
        if (AdUtil_1.AdUtil.inserAdIsPlay["inserAd" + id] == true && isLoad) {
            AdUtil_1.AdUtil.loadAdVideo(id);
            console.log("\u9884\u52A0\u8F7D\u5E7F\u544Aid" + id + "\u9884\u52A0\u8F7D\u4E86");
        }
        console.log("\u9884\u52A0\u8F7D\u5E7F\u544Aid" + id + ",\u662F\u5426\u8981\u9884\u52A0\u8F7D\u4E86" + isLoad + ",\u968F\u673A\u5230\u7684\u6982\u7387" + random);
    },
    //加载插屏视频
    loadAdInsertVideo: function (adPosition, suc) {
        if (suc === void 0) { suc = function () { }; }
        if (AdUtil_1.AdUtil.inserAdIsPlay["inserAd" + adPosition]) {
            AdController_1.default.loadAd(AdPosition_1.AdPosition.SignAwardInsert, suc);
        }
    },
    //特殊图鉴处理
    checkTuJian: function (level) {
        var tempTuJian = [5, 9, 11, 17, 22, 25, 30, 34, 29, 28, 38];
        for (var i = 0; i < tempTuJian.length; i++) {
            if (tempTuJian[i] == level) {
                return true;
            }
        }
        return false;
    },
    //检查当前等级替换的地图
    checkLvBg: function (curLv) {
        var mapData = [
            { mapId: 1, minLv: 1, maxLv: 15, color: "#BB420E" },
            { mapId: 2, minLv: 16, maxLv: 42, color: "#BB420E" },
            { mapId: 1, minLv: 43, maxLv: 69, color: "#BB420E" },
            { mapId: 1, minLv: 70, maxLv: 9999, color: "#1C83BC" },
        ];
        for (var i = 0; i < mapData.length; i++) {
            if (curLv >= mapData[i].minLv && curLv <= mapData[i].maxLv) {
                return mapData[i];
            }
        }
        return mapData[mapData.length - 1];
    },
    //排序
    sortArray: function (sortArray, compareProperty, targetArray) {
        targetArray.sort(function (a, b) {
            var aScore = 100;
            var bScore = 100;
            for (var i = 0; i < sortArray.length; i++) {
                if (a[compareProperty] != null && b[compareProperty] != null) {
                    if (a[compareProperty] == sortArray[i]) {
                        aScore = aScore * i;
                    }
                    if (b[compareProperty] == sortArray[i]) {
                        bScore = bScore * i;
                    }
                }
            }
            return aScore - bScore;
        });
    },
    isATest: function () {
        return AppInfo_1.getPhead().ab_user_type == "A";
    },
};

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxBc3Npc3RcXEFzc2lzdEN0ci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxtREFBa0Q7QUFDbEQsMkNBQXNDO0FBQ3RDLGlEQUFnRTtBQUdoRSxzRUFBaUU7QUFDakUsMERBQXlEO0FBQ3pELGdFQUFnRTtBQUVoRSxxQ0FBZ0M7QUFFbkIsUUFBQSxTQUFTLEdBQUc7SUFFckIsV0FBVyxZQUFDLEdBQUc7UUFDWCxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUM7UUFDZixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBRSxVQUFVLEdBQUcsRUFBRSxLQUFLO1lBQzlDLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLEtBQUssS0FBSyxJQUFJLEVBQUU7Z0JBQzdDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtvQkFDN0IsS0FBSztvQkFDTCxPQUFPO2lCQUNWO2dCQUNELFNBQVM7Z0JBQ1QsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNyQjtZQUNELE9BQU8sS0FBSyxDQUFDO1FBQ2pCLENBQUMsQ0FBQyxDQUFDO1FBQ0gsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLGtCQUFrQjtRQUNoQyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDMUIsQ0FBQztJQUVELFdBQVcsRUFBWCxVQUFZLEdBQVksRUFBRSxJQUFhO1FBQ25DLE9BQU8sSUFBSSxDQUFDLHFCQUFxQixDQUFDLEdBQUcsQ0FBQyxDQUFBO0lBQzFDLENBQUM7SUFDRCxXQUFXLEVBQVgsVUFBWSxRQUFpQixFQUFFLElBQWE7UUFDeEMsT0FBTyxJQUFJLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUE7SUFDOUMsQ0FBQztJQUVELFVBQVUsRUFBVixVQUFXLElBQUk7UUFDWCxJQUFJLElBQUksR0FBUSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMvQixJQUFJLEVBQUUsR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLEdBQUcsR0FBRyxDQUFDO1FBQ2xDLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztRQUM5RixJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUN6RSxJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQztRQUNoRixJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQztRQUN0RixJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FB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QyxDQUFDO3FCQUN2QjtpQkFDSjthQUNKO1lBQ0QsT0FBTyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQzNCLENBQUMsQ0FBQyxDQUFBO0lBQ04sQ0FBQztJQUVELE9BQU87UUFDSCxPQUFPLGtCQUFRLEVBQUUsQ0FBQyxZQUFZLElBQUksR0FBRyxDQUFBO0lBQ3pDLENBQUM7Q0FFSixDQUFBIiwiZmlsZSI6IiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWRQb3NpdGlvbiB9IGZyb20gXCIuLi9jb21tb24vQWRQb3NpdGlvblwiO1xuaW1wb3J0IE5hbWVUcyBmcm9tIFwiLi4vY29tbW9uL05hbWVUc1wiO1xuaW1wb3J0IHsgUE9JTlQsIFBST1BTLCBSRVdBUkRfVFlQRSB9IGZyb20gXCIuLi9jb21tb24vUHJvcENvbnN0XCI7XG5pbXBvcnQgdHVycmV0IGZyb20gXCIuLi9nYW1lL3R1cnJldC90dXJyZXRcIjtcbmltcG9ydCB7IFVybENvbnN0IH0gZnJvbSBcIi4uL3NlcnZlci9VcmxDb25zdFwiO1xuaW1wb3J0IEFkQ29udHJvbGxlciBmcm9tIFwiLi4vc2VydmVyL3htc2RrX2NvY29zL0FEL0FkQ29udHJvbGxlclwiO1xuaW1wb3J0IHsgQWRVdGlsIH0gZnJvbSBcIi4uL3NlcnZlci94bXNka19jb2Nvcy9BRC9BZFV0aWxcIjtcbmltcG9ydCB7IGdldFBoZWFkIH0gZnJvbSBcIi4uL3NlcnZlci94bXNka19jb2Nvcy9Db25maWcvQXBwSW5mb1wiO1xuaW1wb3J0IFhNU0RLIGZyb20gXCIuLi9zZXJ2ZXIveG1zZGtfY29jb3MvWE1TREtcIjtcbmltcG9ydCB1dGlsIGZyb20gXCIuLi91dGlsL3V0aWxcIjtcblxuZXhwb3J0IGNvbnN0IEFzc2lzdEN0ciA9IHtcblxuICAgIGNsb25lT2JqZWN0KG9iaikgey8v5L2/55SoanNvbuS9nOa3seW6puaLt+i0nVxuICAgICAgICB2YXIgY2FjaGUgPSBbXTtcbiAgICAgICAgdmFyIHN0ciA9IEpTT04uc3RyaW5naWZ5KG9iaiwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlLmluZGV4T2YodmFsdWUpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyDnp7vpmaRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyDmlLbpm4bmiYDmnInnmoTlgLxcbiAgICAgICAgICAgICAgICBjYWNoZS5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNhY2hlID0gbnVsbDsgLy8g5riF56m65Y+Y6YeP77yM5L6/5LqO5Z6D5Zy+5Zue5pS25py65Yi25Zue5pS2XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHN0cilcbiAgICB9LFxuXG4gICAgbm9kZVRvV29ybGQocG9zOiBjYy5WZWMyLCBub2RlOiBjYy5Ob2RlKSB7XG4gICAgICAgIHJldHVybiBub2RlLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihwb3MpXG4gICAgfSxcbiAgICB3b3JsZFRvTm9kZSh3b3JsZFBvczogY2MuVmVjMiwgbm9kZTogY2MuTm9kZSkge1xuICAgICAgICByZXR1cm4gbm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2VBUih3b3JsZFBvcylcbiAgICB9LFxuXG4gICAgZm9ybWF0RGF0ZShkYXRlKSB7XG4gICAgICAgIHZhciBkYXRlOiBhbnkgPSBuZXcgRGF0ZShkYXRlKTtcbiAgICAgICAgdmFyIFlZID0gZGF0ZS5nZXRGdWxsWWVhcigpICsgJy0nO1xuICAgICAgICB2YXIgTU0gPSAoZGF0ZS5nZXRNb250aCgpICsgMSA8IDEwID8gJzAnICsgKGRhdGUuZ2V0TW9udGgoKSArIDEpIDogZGF0ZS5nZXRNb250aCgpICsgMSkgKyAnLSc7XG4gICAgICAgIHZhciBERCA9IChkYXRlLmdldERhdGUoKSA8IDEwID8gJzAnICsgKGRhdGUuZ2V0RGF0ZSgpKSA6IGRhdGUuZ2V0RGF0ZSgpKTtcbiAgICAgICAgdmFyIGhoID0gKGRhdGUuZ2V0SG91cnMoKSA8IDEwID8gJzAnICsgZGF0ZS5nZXRIb3VycygpIDogZGF0ZS5nZXRIb3VycygpKSArICc6JztcbiAgICAgICAgdmFyIG1tID0gKGRhdGUuZ2V0TWludXRlcygpIDwgMTAgPyAnMCcgKyBkYXRlLmdldE1pbnV0ZXMoKSA6IGRhdGUuZ2V0TWludXRlcygpKSArICc6JztcbiAgICAgICAgdmFyIHNzID0gKGRhdGUuZ2V0U2Vjb25kcygpIDwgMTAgPyAnMCcgKyBkYXRlLmdldFNlY29uZHMoKSA6IGRhdGUuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgcmV0dXJuIFlZICsgTU0gKyBERCArIFwiIFwiICsgaGggKyBtbSArIHNzO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gdmFsdWUg56eSXG4gICAgICovXG4gICAgZm9ybWF0U2Vjb25kcyh2YWx1ZSk6c3RyaW5nIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHBhcnNlSW50KHZhbHVlKTtcbiAgICAgICAgbGV0IGggPSBNYXRoLmZsb29yKHJlc3VsdCAvIDM2MDApIDwgMTAgPyAnMCcgKyBNYXRoLmZsb29yKHJlc3VsdCAvIDM2MDApIDogTWF0aC5mbG9vcihyZXN1bHQgLyAzNjAwKTtcbiAgICAgICAgbGV0IG0gPSBNYXRoLmZsb29yKChyZXN1bHQgLyA2MCAlIDYwKSkgPCAxMCA/ICcwJyArIE1hdGguZmxvb3IoKHJlc3VsdCAvIDYwICUgNjApKSA6IE1hdGguZmxvb3IoKHJlc3VsdCAvIDYwICUgNjApKTtcbiAgICAgICAgbGV0IHMgPSBNYXRoLmZsb29yKChyZXN1bHQgJSA2MCkpIDwgMTAgPyAnMCcgKyBNYXRoLmZsb29yKChyZXN1bHQgJSA2MCkpIDogTWF0aC5mbG9vcigocmVzdWx0ICUgNjApKTtcblxuICAgICAgICBsZXQgcmVzID0gJyc7XG4gICAgICAgIC8vcmVzICs9IGAke2h9OmA7XG4gICAgICAgIHJlcyArPSBgJHttfTpgO1xuICAgICAgICByZXMgKz0gYCR7c31gO1xuICAgICAgICByZXR1cm4gcmVzOyAgICAgXG4gICAgfSxcblxuICAgIC8v6Led56a7MjTngrnov5jmnInlpJrkuYVcbiAgICBmb3JtYXREYXRhMjQoKTpzdHJpbmd7ICAgICAgICBcbiAgICAgICAgdmFyIGRhdGU6IGFueSA9IG5ldyBEYXRlKCk7ICAgICAgICBcbiAgICAgICAgbGV0IHRlbXBoaCA9IDIzIC0gZGF0ZS5nZXRIb3VycygpO1xuICAgICAgICBsZXQgdGVtcE1pbnV0ZXMgPSA1OSAtIGRhdGUuZ2V0TWludXRlcygpO1xuICAgICAgICBsZXQgdGVtcFNlY29uZHMgPSA1OSAtIGRhdGUuZ2V0U2Vjb25kcygpO1xuXG4gICAgICAgIHZhciBoaCA9ICh0ZW1waGggPCAxMCA/ICcwJyArIHRlbXBoaCA6IHRlbXBoaCkgKyAnOic7XG4gICAgICAgIHZhciBtbSA9ICh0ZW1wTWludXRlcyA8IDEwID8gJzAnICsgdGVtcE1pbnV0ZXMgOiB0ZW1wTWludXRlcykgKyAnOic7XG4gICAgICAgIHZhciBzcyA9ICh0ZW1wU2Vjb25kcyA8IDEwID8gJzAnICsgdGVtcFNlY29uZHMgOiB0ZW1wU2Vjb25kcyk7XG4gICAgICAgIHJldHVybiBoaCArIG1tICsgc3M7XG4gICAgfSxcblxuICAgIGNvbnZlcnROdW1iZXIobnVtID0gMCkge1xuICAgICAgICBpZiAodHlwZW9mIG51bSAhPSAnbnVtYmVyJykge1xuICAgICAgICAgICAgbnVtID0gTnVtYmVyKG51bSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTmFOKG51bSkpIHtcbiAgICAgICAgICAgIG51bSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYobnVtID49IDEwMDAwKXtcbiAgICAgICAgICAgIHJldHVybiAgKG51bSAvIDEwMDAwKS50b0ZpeGVkKDEpICsgJ3cnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYobnVtID49IDEwMDApe1xuICAgICAgICAgICAgcmV0dXJuICAobnVtIC8gMTAwMCkudG9GaXhlZCgxKSArICdrJztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVtO1xuICAgIH0sXG5cbiAgICBmaW5kUHJvcFNwcml0ZSh0eXBlLCBrZXlJZCwgc3VjQ2FsbCwgZXJyQ2FsbD8pIHtcbiAgICAgICAgaWYgKHR5cGUgPT0gUkVXQVJEX1RZUEUuUFJPUFMpIHtcbiAgICAgICAgICAgIGlmIChQUk9QU1trZXlJZF0pIHtcbiAgICAgICAgICAgICAgICBjYy5yZXNvdXJjZXMubG9hZChgQWN0aXZ5UmVzb3VyY2UvSW1hZ2UvUHJvcC8ke1BST1BTW2tleUlkXS5pY29ufWAsIGNjLlNwcml0ZUZyYW1lLCBmdW5jdGlvbiAoZXJyLCBzcHJpdGVGcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyQ2FsbCkgZXJyQ2FsbFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VjQ2FsbCkgc3VjQ2FsbChzcHJpdGVGcmFtZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoUE9JTlRba2V5SWRdKSB7XG4gICAgICAgICAgICAgICAgY2MucmVzb3VyY2VzLmxvYWQoYEFjdGl2eVJlc291cmNlL0ltYWdlL1BvaW50LyR7UE9JTlRba2V5SWRdLm5hbWV9YCwgY2MuU3ByaXRlRnJhbWUsIGZ1bmN0aW9uIChlcnIsIHNwcml0ZUZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnJDYWxsKSBlcnJDYWxsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWNDYWxsKSBzdWNDYWxsKHNwcml0ZUZyYW1lKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsXG4gICAgfSxcbiAgICByZW1vdmVFbGVGcm9tQXJyYXkoZWxlOiBhbnksIGFycjogQXJyYXk8YW55Pikge1xuICAgICAgICBsZXQgaW5kZXggPSBhcnIuaW5kZXhPZihlbGUpXG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgICAgICBhcnIuc3BsaWNlKGluZGV4LCAxKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJcbiAgICB9LFxuICAgIGhhc0VsZUluQXJyYXkoZWxlOiBhbnksIGFycjogQXJyYXk8YW55Pikge1xuICAgICAgICByZXR1cm4gYXJyLmluZGV4T2YoZWxlKSA+IC0xXG4gICAgfSxcbiAgICBmaW5kQXJySW5BcnIoYXJyMSwgYXJyMikgey8v6L+U5ZueYXJyMuWSjGFycjHkuK3lkIzml7blrZjlnKjnmoTlgLxcbiAgICAgICAgbGV0IGFyciA9IFtdXG4gICAgICAgIGZvciAobGV0IG0gaW4gYXJyMikge1xuICAgICAgICAgICAgaWYgKGFycjJbbV0gJiYgYXJyMS5pbmRleE9mKGFycjJbbV0pID4gLTEpIHtcbiAgICAgICAgICAgICAgICBhcnIucHVzaChhcnIyW21dKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJcbiAgICB9LFxuICAgIGZpbmRBcnJOb0FycihhcnIxLCBhcnIyKSB7Ly/ov5Tlm55hcnIy5Lit6Zmk5Y67YXJyMeeahOWAvFxuICAgICAgICBsZXQgYXJyID0gW11cbiAgICAgICAgZm9yIChsZXQgbSBpbiBhcnIyKSB7XG4gICAgICAgICAgICBpZiAoYXJyMlttXSAmJiBhcnIxLmluZGV4T2YoYXJyMlttXSkgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhcnIucHVzaChhcnIyW21dKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJcbiAgICB9LFxuICAgIHBsYXlBbmltYXRlKHNwcml0ZUZyYW1lLCBzdGFydE5vZGUsIHRhcmdldCwgY2FsbGJhY2spIHtcbiAgICAgICAgbGV0IGNhbnZhc05vZGUgPSBjYy5kaXJlY3Rvci5nZXRTY2VuZSgpLmdldENoaWxkQnlOYW1lKCdDYW52YXMnKTtcbiAgICAgICAgbGV0IHN0YXJ0UG9zID0gY2FudmFzTm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2VBUihzdGFydE5vZGUuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKDAsIDApKSk7XG4gICAgICAgIGxldCBlbmRQb3MgPSBjYW52YXNOb2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKHRhcmdldC5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoMCwgMCkpKTtcblxuICAgICAgICBsZXQgbm9kZSA9IG5ldyBjYy5Ob2RlKCk7XG4gICAgICAgIC8vbm9kZS5zZXRDb250ZW50U2l6ZSgxMzYsIDEzNik7XG4gICAgICAgIG5vZGUuekluZGV4ID0gMjAwMTtcbiAgICAgICAgbm9kZS5zZXRQb3NpdGlvbihzdGFydFBvcyk7XG4gICAgICAgIGxldCBzcHJpdGUgPSBub2RlLmFkZENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcbiAgICAgICAgc3ByaXRlLnR5cGUgPSBjYy5TcHJpdGUuVHlwZS5TSU1QTEU7XG4gICAgICAgIHNwcml0ZS5zaXplTW9kZSA9IGNjLlNwcml0ZS5TaXplTW9kZS5SQVc7XG4gICAgICAgIHNwcml0ZS50cmltID0gZmFsc2U7XG4gICAgICAgIG5vZGUuc2NhbGUgPSAxO1xuICAgICAgICBub2RlLnBhcmVudCA9IGNhbnZhc05vZGU7XG4gICAgICAgIGxldCBhY3Rpb25zID0gW107XG4gICAgICAgIGxldCBtaWRQb3MgPSBjYy52MihzdGFydFBvcy54ICsgMTUwLCBzdGFydFBvcy55IC0gMTUwKTtcbiAgICAgICAgbGV0IGJlemllciA9IFtzdGFydFBvcywgbWlkUG9zLCBlbmRQb3NdO1xuICAgICAgICBsZXQgYmV6aWVyVG8gPSBjYy5iZXppZXJUbygwLjUsIGJlemllcik7XG4gICAgICAgIGxldCBzY2FsZVRvID0gY2Muc2NhbGVUbygwLjUsIDAuMywgMC4zKVxuICAgICAgICBhY3Rpb25zLnB1c2goY2MuZGVsYXlUaW1lKDAuMykpO1xuICAgICAgICBhY3Rpb25zLnB1c2goY2Muc3Bhd24oc2NhbGVUbywgYmV6aWVyVG8pKTtcbiAgICAgICAgYWN0aW9ucy5wdXNoKGNjLmZhZGVPdXQoMC4yKSlcbiAgICAgICAgYWN0aW9ucy5wdXNoKGNjLmNhbGxGdW5jKCgpID0+IHtcbiAgICAgICAgICAgIG5vZGUuZGVzdHJveSgpO1xuICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2sodGFyZ2V0KTtcbiAgICAgICAgfSkpXG5cbiAgICAgICAgbm9kZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoYWN0aW9ucykpO1xuICAgIH0sXG5cbiAgICBzaG93VG9hc3RUaXAobXNnOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNTaG93TXNnKSByZXR1cm5cbiAgICAgICAgdGhpcy5pc1Nob3dNc2cgPSB0cnVlXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc1Nob3dNc2cgPSBmYWxzZVxuICAgICAgICB9LCAxNTAwKTtcblxuICAgICAgICBjYy5kaXJlY3Rvci5lbWl0KE5hbWVUcy5TaG93X1RvYXN0LCBtc2cpO1xuICAgIH0sXG5cbiAgICAvL+ajgOafpeaPkuWxj+amgueOh1xuICAgIGNoZWNrSXNPcGVuSW5zZXJBZChpZCwgaXNMb2FkID0gdHJ1ZSkge1xuICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgbGV0IGlzUGxheSA9IGZhbHNlO1xuICAgICAgICBBZFV0aWwuaW5zZXJBZElzUGxheVtgaW5zZXJBZCR7aWR9YF0gPSB0cnVlO1xuXG4gICAgICAgIGlmIChpZCA9PSBBZFBvc2l0aW9uLlNpZ25Bd2FyZEluc2VydCkge1xuICAgICAgICAgICAgaWYgKGlkID09IEFkUG9zaXRpb24uU2lnbkF3YXJkSW5zZXJ0ICYmICF1dGlsLnVzZXJEYXRhLm5ld1VzZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAocmFuZG9tIDw9IDAuNSkge1xuICAgICAgICAgICAgICAgICAgICBpc1BsYXkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBBZFV0aWwuaW5zZXJBZElzUGxheVtgaW5zZXJBZCR7aWR9YF0gPSBpc1BsYXk7XG5cbiAgICAgICAgaWYgKEFkVXRpbC5pbnNlckFkSXNQbGF5W2BpbnNlckFkJHtpZH1gXSA9PSB0cnVlICYmIGlzTG9hZCkge1xuICAgICAgICAgICAgQWRVdGlsLmxvYWRBZFZpZGVvKGlkKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDpooTliqDovb3lub/lkYppZCR7aWR96aKE5Yqg6L295LqGYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coYOmihOWKoOi9veW5v+WRimlkJHtpZH0s5piv5ZCm6KaB6aKE5Yqg6L295LqGJHtpc0xvYWR9LOmaj+acuuWIsOeahOamgueOhyR7cmFuZG9tfWApO1xuICAgIH0sXG5cbiAgICAvL+WKoOi9veaPkuWxj+inhumikVxuICAgIGxvYWRBZEluc2VydFZpZGVvKGFkUG9zaXRpb246IG51bWJlciwgc3VjID0gKCkgPT4geyB9KSB7XG4gICAgICAgIGlmIChBZFV0aWwuaW5zZXJBZElzUGxheVtgaW5zZXJBZCR7YWRQb3NpdGlvbn1gXSkge1xuICAgICAgICAgICAgQWRDb250cm9sbGVyLmxvYWRBZChBZFBvc2l0aW9uLlNpZ25Bd2FyZEluc2VydCwgc3VjKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvL+eJueauiuWbvumJtOWkhOeQhlxuICAgIGNoZWNrVHVKaWFuKGxldmVsKSB7XG4gICAgICAgIGxldCB0ZW1wVHVKaWFuID0gWzUsIDksIDExLCAxNywgMjIsIDI1LCAzMCwgMzQsIDI5LCAyOCwgMzhdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRlbXBUdUppYW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh0ZW1wVHVKaWFuW2ldID09IGxldmVsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sXG5cbiAgICAvL+ajgOafpeW9k+WJjeetiee6p+abv+aNoueahOWcsOWbvlxuICAgIGNoZWNrTHZCZyhjdXJMdjogbnVtYmVyKSB7XG4gICAgICAgIGxldCBtYXBEYXRhID0gW1xuICAgICAgICAgICAgeyBtYXBJZDogMSwgbWluTHY6IDEsIG1heEx2OiAxNSwgY29sb3I6IFwiI0JCNDIwRVwiIH0sXG4gICAgICAgICAgICB7IG1hcElkOiAyLCBtaW5MdjogMTYsIG1heEx2OiA0MiwgY29sb3I6IFwiI0JCNDIwRVwiIH0sXG4gICAgICAgICAgICB7IG1hcElkOiAxLCBtaW5MdjogNDMsIG1heEx2OiA2OSwgY29sb3I6IFwiI0JCNDIwRVwiIH0sXG4gICAgICAgICAgICB7IG1hcElkOiAxLCBtaW5MdjogNzAsIG1heEx2OiA5OTk5LCBjb2xvcjogXCIjMUM4M0JDXCIgfSwgICAgICAgICBcbiAgICAgICAgXVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFwRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGN1ckx2ID49IG1hcERhdGFbaV0ubWluTHYgJiYgY3VyTHYgPD0gbWFwRGF0YVtpXS5tYXhMdikge1xuICAgICAgICAgICAgICAgIHJldHVybiBtYXBEYXRhW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXBEYXRhW21hcERhdGEubGVuZ3RoIC0gMV07XG4gICAgfSwgIFxuXG4gICAgLy/mjpLluo9cbiAgICBzb3J0QXJyYXkoc29ydEFycmF5LCBjb21wYXJlUHJvcGVydHk6c3RyaW5nLCB0YXJnZXRBcnJheSl7XG4gICAgICAgIHRhcmdldEFycmF5LnNvcnQoKGEsIGIpPT57XG4gICAgICAgICAgICBsZXQgYVNjb3JlID0gMTAwO1xuICAgICAgICAgICAgbGV0IGJTY29yZSA9IDEwMDtcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzb3J0QXJyYXkubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgIGlmKGFbY29tcGFyZVByb3BlcnR5XSAhPSBudWxsICYmIGJbY29tcGFyZVByb3BlcnR5XSAhPSBudWxsKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoYVtjb21wYXJlUHJvcGVydHldID09IHNvcnRBcnJheVtpXSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBhU2NvcmUgPSBhU2NvcmUgKiBpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmKGJbY29tcGFyZVByb3BlcnR5XSA9PSBzb3J0QXJyYXlbaV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgYlNjb3JlID0gYlNjb3JlICogaTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhU2NvcmUgLSBiU2NvcmU7XG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIGlzQVRlc3QoKSB7Ly/mmK/lkKbkuLpBQuS4reeahEHnlKjmiLdcbiAgICAgICAgcmV0dXJuIGdldFBoZWFkKCkuYWJfdXNlcl90eXBlID09IFwiQVwiXG4gICAgfSxcblxufSJdfQ==