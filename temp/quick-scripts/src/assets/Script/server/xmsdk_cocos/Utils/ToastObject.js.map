{"version":3,"sources":["assets\\Script\\server\\xmsdk_cocos\\Utils\\ToastObject.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { DurConfig, TextConfig, PosConfig } from \"./XMToast\";\n\nexport class ToastObject {\n    text: string;\n    duration: number = null;\n    position: PosConfig = null;\n    x: number = 0;\n    y: number = 0;\n\n    retryLoadBgCount: number = 0;\n\n    private bgSpriteFrame: cc.SpriteFrame = null;\n\n    constructor(_text: string, _duration: number) {\n        this.text = _text;\n        this.duration = _duration;\n    }\n\n    public setPosition(pos: PosConfig, _x: number, _y: number): void {\n        if (pos == null || pos == undefined) {\n            pos = PosConfig.BOTTOM;\n        }\n        this.position = pos;\n        this.x = _x;\n        this.y = _y;\n    }\n\n    public show(): void {\n        //加载背景纹理\n        if (this.bgSpriteFrame == null) {\n            this.loadBg();\n            return;\n        }\n\n        var canvas = cc.director.getScene().getComponentInChildren(cc.Canvas);\n        var width = canvas.node.width;\n        var height = canvas.node.height;\n        //默认使用短时间提示\n        if (this.duration == null || this.duration == undefined) {\n            this.duration = DurConfig.SHORT;\n        }\n\n        //背景图片设置\n        let bgNode = new cc.Node();\n        bgNode.opacity = 200;//设置背景图片透明度\n        bgNode.zIndex = 10000;\n        // 添加一个精灵背景\n        let bgSprite = bgNode.addComponent(cc.Sprite);\n        bgSprite.type = cc.Sprite.Type.SLICED;\n        //添加一个widget组件, 方便定位\n        let widget = bgNode.addComponent(cc.Widget);\n        widget.alignMode = cc.Widget.AlignMode.ONCE;\n        // 添加一个Layout\n        let bgLayout = bgNode.addComponent(cc.Layout);\n        bgLayout.resizeMode = cc.Layout.ResizeMode.CONTAINER;\n        // 添加一个Label\n        let textNode = new cc.Node();\n        let textLabel = textNode.addComponent(cc.Label);\n\n        // Label文字设置\n        textLabel.horizontalAlign = cc.Label.HorizontalAlign.CENTER;\n        textLabel.verticalAlign = cc.Label.VerticalAlign.CENTER;\n        textLabel.fontSize = TextConfig.FONT_SIZE;\n        textLabel.lineHeight = TextConfig.LINE_HIGHT;\n        textLabel.string = this.text;\n\n        //背景图片和文本内容间距\n        bgLayout.paddingLeft = TextConfig.H_PADDING;\n        bgLayout.paddingRight = TextConfig.H_PADDING;\n        bgLayout.paddingTop = TextConfig.V_PADDING;\n        bgLayout.paddingBottom = TextConfig.V_PADDING;\n\n        //文本过长时，设置为自动换行\n        if (this.text.length * textLabel.fontSize > (width - TextConfig.W_SPACEING)) {\n            textNode.width = (width - TextConfig.W_SPACEING);\n            textLabel.overflow = cc.Label.Overflow.RESIZE_HEIGHT;\n        }\n\n        bgNode.addChild(textNode);\n\n        if (this.bgSpriteFrame) {\n            bgSprite.getComponent(cc.Sprite).spriteFrame = this.bgSpriteFrame;\n        }\n\n        // 设置toast位置\n        if (this.position == PosConfig.CENTER) {\n            widget.isAlignTop = true;\n            widget.isAlignBottom = true;\n            widget.top = 0;\n            widget.bottom = 0;\n            textNode.setAnchorPoint(0.5, 0.5);\n\n        } else if (this.position == PosConfig.TOP) {\n            widget.isAlignTop = true;\n            widget.isAlignBottom = false;\n            widget.isAbsoluteTop = true;\n            widget.top = TextConfig.B_SPACEING;\n            textNode.setAnchorPoint(0.5, 1);\n\n        } else if (this.position == PosConfig.BOTTOM) {\n            widget.isAlignTop = false;\n            widget.isAlignBottom = true;\n            widget.isAbsoluteBottom = true;\n            widget.bottom = TextConfig.B_SPACEING;\n            textNode.setAnchorPoint(0.5, 0);\n        }\n\n        canvas.node.addChild(bgNode);\n\n        let finished = cc.callFunc((target) => {\n            bgNode.destroy();\n        }, this);\n        let action = cc.sequence(cc.moveBy(this.duration, cc.v2(0, 0)), cc.fadeOut(0.3), finished);\n\n        bgNode.runAction(action);\n    }\n\n    private loadBg(): void {\n        if(this.retryLoadBgCount >= 3){\n            this.bgSpriteFrame = new cc.SpriteFrame();\n            this.show();\n            return;\n        }\n        cc.loader.loadRes(\"Toast/bgSprite\", function (err, ret) {\n            if (err) {\n                this.retryLoadBgCount++;\n                console.info(\"bgSprite加载失败\", err);\n            } else {\n                this.bgSpriteFrame = new cc.SpriteFrame(ret);\n                this.bgSpriteFrame.insetTop = 24;\n                this.bgSpriteFrame.insetBottom = 24;\n                this.bgSpriteFrame.insetLeft = 40;\n                this.bgSpriteFrame.insetRight = 40;\n            }\n\n            //加载完成再调用\n            this.show();\n        }.bind(this));\n    }\n}\n"]}