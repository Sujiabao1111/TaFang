{"version":3,"sources":["assets\\Script\\pop\\gameUpgrade.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { AssistCtr } from \"../Assist/AssistCtr\";\nimport baseTs from \"../base/baseTs\";\nimport { AdPosition } from \"../common/AdPosition\";\nimport NameTs from \"../common/NameTs\";\nimport pageTs from \"../common/pageTs\";\nimport AdController from \"../server/xmsdk_cocos/AD/AdController\";\nimport XMSDK from \"../server/xmsdk_cocos/XMSDK\";\nimport soundController from \"../soundController\";\nimport TrackMgr from \"../TrackMgr/TrackMgr\";\nimport util from \"../util/util\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class gameUpgrade extends baseTs {\n\n    @property({type:cc.Label,displayName:\"炮塔数量\"})\n    private turretNumLabel:cc.Label = null;\n\n    // @property({type:cc.Node,displayName:\"光\"})\n    // private light:cc.Node = null;\n\n    @property({type:cc.Sprite,displayName:\"炮塔身\"})\n    private turretBody:cc.Sprite = null;\n\n    @property({type:cc.Sprite,displayName:\"炮塔脚\"})\n    private turretFoot:cc.Sprite = null;\n\n    \n    @property({type:cc.Label,displayName:\"等级\"})\n    private levelLabel:cc.Label = null;\n    \n    @property({type:cc.Label,displayName:\"名字\"})\n    private nameLabel:cc.Label = null;\n    \n    \n    @property({type:[cc.Node],displayName:\"按钮\"})\n    private arrBtn:cc.Node[] = [];\n    \n    // @property({type:cc.Node,displayName:\"倍数\"})\n    // private multipleNode:cc.Node = null;\n\n    @property({type:cc.Node,displayName:\"信息流\"})\n    private feed_node:cc.Node = null;\n    \n    \n    @property({type:cc.Node,displayName:\"倍数\"})\n    private multipleNode:cc.Node = null;\n    \n    @property({type:cc.Label,displayName:\"倍数金币\"})\n    private lable_addGold2:cc.Label = null;\n\n    \n    /**金币 */\n    private coin:number = 1;\n    /**原始数量 */\n    private num:number = 5;\n\n    private initData:any;\n\n    onLoad () {\n\n    }\n\n    start () {\n\n        // cc.tween(this.light).repeatForever(\n        //     cc.tween().to(1,{scale:1}).to(1,{scale:1.1})\n        // ).start();\n        \n        cc.tween(this.multipleNode).repeatForever(\n            cc.tween().to(.3,{angle:10}).to(.2,{angle:0})\n        ).start();\n    }\n\n    /**初始化 */\n    init(data){\n\n        TrackMgr.AppBuyProductDialog_hcdg({\n            dialog_name_hcdg: \"解锁新炮塔\",\n        });\n\n        this.initData = util.GetTurretData(util.userData.turretLevel);\n\n        if(this.initData.level==2){\n            TrackMgr.rookie_process({\n                activity_state :\"首次解锁炮塔弹窗\",\n                synthesis_successful:true\n            });\n            if(util.checkTestB(NameTs.lock_turret_test)){\n                util.addTermCoin(2800);\n                this.coin = 2800;\n            }else{\n                this.coin = util.GetBehaviorRewardVo(1);\n            }\n            this.turretNumLabel.string  = \"+\"+this.coin+\"红包币\";\n        }else{\n            \n            this.turretNumLabel.string  = \"+\"+this.num+\"炮塔\";\n        }\n\n        console.log(this.coin,'this.coin')\n\n        \n        \n        //存合成次数和时间\n        util.setStorage(util.localDiary.unlocking_time,util.userData.unlocking_time);\n\n        \n        this.levelLabel.string = \"Lv.\"+this.initData.level;\n        this.nameLabel.string = this.initData.name;\n\n        this.loadSprite(\"body\",(res)=>{\n            this.turretBody&&(this.turretBody.spriteFrame = res);\n        })\n        this.loadSprite(\"foot\",(res)=>{\n            if(this.turretFoot&&res){\n                this.turretFoot.node.active = true;\n                this.turretFoot.spriteFrame = res\n            }else{\n                this.turretFoot.node.active = false;\n            }\n            if(Number(this.initData.spriteFootY)>0){\n                    this.turretFoot&&(this.turretFoot.node.y = Number(this.initData.spriteFootY));\n            }\n        })\n\n        util.sendTurretData();\n        cc.game.emit(NameTs.Game_Buy_update);\n\n        XMSDK.trackUserProperties({\n            top_synthesis: util.userData.compoundTimes,\n        });\n\n        if(!util.adPreObj[AdPosition.UnlcokTurret]){\n            util.preloadAd(AdPosition.UnlcokTurret);\n        }\n\n        this.arrBtn[0].active = util.userData.noviceGuide==2;\n        this.arrBtn[1].active = this.arrBtn[2].active =  util.userData.noviceGuide!==2;\n        \n    }\n\n\n    /**\n     * 获取\n     */\n    getBtn(e,res){\n        soundController.singleton.clickAudio();\n        if(util.userData.noviceGuide==2){\n            if(!util.checkTestB(NameTs.new_hand_test)){\n                this.showPage(pageTs.pageName.GameGuide2,3);\n            }\n            cc.game.emit(NameTs.Game_Effect_coin,{node:this.node,value:this.coin,num:5});\n            util.addTermCoin(this.coin);\n            util.sendTurretData();\n            this.closePage();\n            return;\n        }\n\n        let successFn = ()=>{\n            let num:number = this.num*(res==1?2:1);\n            cc.game.emit(NameTs.Game_Effect_turret,{node:this.node,num});\n            util.productTurret(num);\n            this.closePage();\n            // this.showPage(pageTs.pageName.GameGetTurret,{num,name:pageTs.pageName.GameUpgrade}); \n\n            if(res == 1){\n                TrackMgr.AppDialogClick_hcdg({\n                    dialog_name_hcdg: \"解锁新炮塔\",\n                    ck_module:\"多倍领取\",\n                    active_ad_hcdg:\"激励视频\"\n                }); \n            }\n            else{\n                TrackMgr.AppDialogClick_hcdg({\n                    dialog_name_hcdg: \"解锁新炮塔\",\n                    ck_module:\"普通领取\",                    \n                }); \n            }\n        }\n\n        if(res==1){\n            AdController.loadAd(AdPosition.UnlcokTurret,()=>{\n                util.preloadAd(AdPosition.UnlcokTurret);\n                successFn();\n            }, () => {\n                AssistCtr.showToastTip(\"加载视频失败，请稍后！\");\n            });\n        }else{\n            successFn();\n        }\n\n    }\n\n   /**\n     * 加载图片\n     */\n    loadSprite(name:string,call:Function){\n        cc.resources.load(this.initData[name],cc.SpriteFrame,(err,res:cc.SpriteFrame)=>{\n\n            if(err){\n                console.error(\"找不到该图片\",err);\n            }\n            call(res);\n\n        });\n    }\n    onEnable() {\n        AdController.loadInfoAd(AdPosition.UnlcokTurretView, 636, this.feed_node);//636:feedNode信息流容器节点的宽度\n        // if(util.adPreObj[AdPosition.UnlcokTurretView]){\n        //     util.preloadAd(AdPosition.UnlcokTurretView,true);\n        // }\n    }\n\n\n    onDisable() {\n        AdController.hideInfoAd(AdPosition.UnlcokTurretView);\n    }\n    // update (dt) {}\n}\n"]}