{"version":3,"sources":["assets\\Script\\pop\\gameTreasure.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { AssistCtr } from \"../Assist/AssistCtr\";\nimport baseTs from \"../base/baseTs\";\nimport { AdPosition } from \"../common/AdPosition\";\nimport { gameNumerical } from \"../common/faceTs\";\nimport NameTs from \"../common/NameTs\";\nimport { UrlConst } from \"../server/UrlConst\";\nimport AdController from \"../server/xmsdk_cocos/AD/AdController\";\nimport soundController from \"../soundController\";\nimport TrackMgr from \"../TrackMgr/TrackMgr\";\nimport util from \"../util/util\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class gameTreasure extends baseTs {\n\n    @property({type:cc.ProgressBar,displayName:\"进度条\"})\n    private progress:cc.ProgressBar = null;\n    \n    @property({type:cc.Node,displayName:\"宝箱页面\"})\n    private content1:cc.Node = null;\n    \n    @property({type:cc.Node,displayName:\"金币页\"})\n    private content2:cc.Node = null;\n\n    @property({type:cc.Label,displayName:\"金币label\"})\n    private coinLabel:cc.Label = null;\n\n    @property({type:cc.Node,displayName:\"关闭1\"})\n    private closeBtnNode1:cc.Node = null;\n    \n    @property({type:cc.Node,displayName:\"关闭2\"})\n    private closeBtnNode2:cc.Node = null;\n    \n    @property({type:cc.Node,displayName:\"金币\"})\n    private goldNode:cc.Node = null;\n    \n    @property({type:cc.Node,displayName:\"金币Box\"})\n    private goldBox:cc.Node = null;\n\n    \n    @property({type:cc.Node,displayName:\"手指\"})\n    private hand:cc.Node = null;\n\n    @property({type:dragonBones.ArmatureDisplay,displayName:\"宝箱骨骼\"})\n    private boxDragon:dragonBones.ArmatureDisplay = null;\n\n    // @property({type:cc.ParticleSystem,displayName:\"粒子\"})\n    // private Particle:cc.ParticleSystem = null;\n\n    \n    @property({type:cc.Node,displayName:\"信息流\"})\n    private feed_node:cc.Node = null;\n    \n    /**金币 */\n    private coin:number = 0;\n\n    //宝箱id\n    private id:number = null;\n\n    //是否播放\n    private isRuning:boolean = false;\n\n    //点击次数\n    private clickNum:number = 0;\n\n    private isStart:boolean = false;\n\n    onLoad () {\n        this.progress.progress = 0;\n        this.closeBtnNode1.active = this.closeBtnNode2.active = false;\n        this.unscheduleAllCallbacks();\n\n        \n    }\n\n    start () {\n        this.scheduleOnce(()=>{\n            this.closeBtnNode1.active = true;\n        },gameNumerical.closeTime);\n\n        \n    }\n\n    init(data){\n        // this.id = data;\n        \n\n        this.isStart = true;\n\n        TrackMgr.airborne_treasure({\n            activity_state: \"漂浮宝箱弹窗\",\n        })\n\n        util.getdataStr({\n            url:UrlConst.treasureBox_residual,\n            success:res=>{\n                if(!this.isValid){\n                    return;\n                }\n\n                this.coin = res.coin;\n                this.coinLabel.string =\"+\"+ this.coin+\"红包币\";\n            }\n        });\n\n        //预加载宝箱\n        if(!util.adPreObj[AdPosition.TreasureBox]){\n            util.preloadAd(AdPosition.TreasureBox);\n        }\n        \n\n    }\n\n    /**\n     * 点击\n     */\n    clickBtn(){\n        soundController.singleton.clickAudio();\n        this.progress.progress += .1;\n        // this.Particle.resetSystem();\n        this.createGold();\n        this.boxDragon.playAnimation(\"shake-red\",1);\n        this.clickNum++;\n        if(this.progress.progress>=1){\n            this.isStart = false;\n            this.content1.active = false;\n            this.content2.active = true;\n            this.scheduleOnce(()=>{\n                this.closeBtnNode2.active = true;\n            },gameNumerical.closeTime);\n\n            TrackMgr.airborne_treasure({\n                activity_state: \"点击「砸开宝箱」按钮\",\n                button:this.clickNum,\n            });\n            TrackMgr.AppDialogClick_hcdg({\n                dialog_name_hcdg: \"空降宝箱（未砸开）\",\n                ck_module:\"狂点砸开\",\n            }); \n        }\n        \n    }\n\n    /**产金币 */\n    createGold(){\n\n        let item:cc.Node = cc.instantiate(this.goldNode);\n        item.active = true;\n        item.setParent(this.goldBox);\n\n    }\n\n    /**\n     * 关闭的\n     */\n    closeBtn(e,res){\n        soundController.singleton.clickAudio();\n        // util.saveTreasureData(this.id);\n        this.closePage();\n        TrackMgr.airborne_treasure({\n            activity_state: \"点击「放弃奖励」按钮\",\n            coin:this.coin,\n            getcoin_status:false\n        })\n\n        if(res==0){\n            TrackMgr.AppDialogClick_hcdg({\n                dialog_name_hcdg: \"空降宝箱（未砸开）\",\n                ck_module:\"残忍放弃\",\n            }); \n        }else{\n            TrackMgr.AppDialogClick_hcdg({\n                dialog_name_hcdg: \"空降宝箱（已砸开）\",\n                ck_module:\"放弃领取\",\n            }); \n        }\n\n        \n    }\n\n    /**\n     * 增加金币\n     */\n    getBtn(){\n\n        soundController.singleton.clickAudio();\n\n        TrackMgr.AppDialogClick_hcdg({\n            dialog_name_hcdg: \"空降宝箱（已砸开）\",\n            ck_module:\"领取1000红包币\",\n            active_ad_hcdg:\"激励视频\"\n        });\n        \n        AdController.loadAd(AdPosition.TreasureBox,()=>{\n            \n            util.preloadAd(AdPosition.TreasureBox);\n            // cc.game.emit(NameTs.Game_Treasure_StartTime);\n\n            util.getdataStr({\n                url:UrlConst.treasureBox_get2,\n                success:res=>{\n                    if(!this.isValid){\n                        return;\n                    }\n\n                    if(res==null){\n                        AssistCtr.showToastTip(\"宝箱还未到时间\");\n                        this.closePage();\n                        return;\n                    }\n                    cc.game.emit(NameTs.Game_Effect_coin,{node:this.node,value:this.coin,num:10});\n                    AssistCtr.showToastTip(\"获得\"+this.coin+\"红包币\");\n                    util.addTermCoin(this.coin);\n                    TrackMgr.airborne_treasure({\n                        activity_state: \"点击「领金币」按钮\",\n                        coin:this.coin\n                    });\n                    cc.game.emit(NameTs.Game_Treasure_StartTime);\n                    this.closePage();\n                }\n            });\n        }, () => {\n            AssistCtr.showToastTip(\"加载视频失败，请稍后！\");\n        });\n\n    }\n\n    onEnable() {   \n        AdController.loadInfoAd(AdPosition.TreasureBoxView, 636, this.feed_node);//636:feedNode信息流容器节点的宽度\n    }\n\n\n    onDisable() {\n        AdController.hideInfoAd(AdPosition.TreasureBoxView);\n    }\n    \n    update (dt) {\n\n        if(this.isStart){\n            this.progress.progress -= 0.003;\n            if(this.progress.progress<0){\n                this.progress.progress = 0;\n            }\n        }\n\n    }\n}\n"]}