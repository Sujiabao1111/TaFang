{"version":3,"sources":["assets\\Script\\pop\\gameToolGet.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { AssistCtr } from \"../Assist/AssistCtr\";\r\nimport baseTs from \"../base/baseTs\";\r\nimport { AdPosition } from \"../common/AdPosition\";\r\nimport NameTs from \"../common/NameTs\";\r\nimport { UrlConst } from \"../server/UrlConst\";\r\nimport AdController from \"../server/xmsdk_cocos/AD/AdController\";\r\nimport TrackMgr from \"../TrackMgr/TrackMgr\";\r\nimport tool from \"../util/tool\";\r\nimport util from \"../util/util\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class gameToolGet extends baseTs {\r\n\r\n    @property(cc.Node)\r\n    viewport:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    bgNode:cc.Node = null;\r\n\r\n    @property(cc.Sprite)\r\n    toolSpr:cc.Sprite = null;    \r\n\r\n    @property(dragonBones.ArmatureDisplay)\r\n    foguang_ske:dragonBones.ArmatureDisplay = null;\r\n\r\n    start() {\r\n        this.foguang_ske.getComponent(dragonBones.ArmatureDisplay).playAnimation(\"foguang-all\", 1)\r\n    }\r\n\r\n    onEnable(){\r\n        this.toolSpr.node.active = true;\r\n        this.bgNode.opacity = 255;\r\n\r\n        TrackMgr.AppBuyProductDialog_hcdg({\r\n            dialog_name_hcdg:\"道具过渡页\"\r\n        })\r\n         \r\n    }\r\n\r\n    init(info){\r\n        this.loadAny(\"texture/prop/prop\" + info.propId, cc.SpriteFrame, res => {\r\n            this.toolSpr.spriteFrame = res;\r\n            AdController.loadAd(AdPosition.Prop, () => {\r\n                this.getTool(info);\r\n            }, ()=>{                \r\n                this.closePage();\r\n                AssistCtr.showToastTip(\"加载视频失败，请稍后！\");\r\n                \r\n            });\r\n        }, ()=>{\r\n            this.getTool(info);\r\n        });\r\n    }\r\n\r\n    getTool(info){\r\n        util.post({\r\n            url: UrlConst.getProp,\r\n            data: { configId: info.id },\r\n            success: (res) => {\r\n                if(!this.isValid){\r\n                    return;\r\n                }\r\n\r\n                let data = tool.GetArrData(\"propId\", info.propId, res.propsList);\r\n                util.userData.prop[Number(data.propId) - 1].num += Number(data.propNum);                    \r\n                //console.log(\"获取道具\", data);\r\n                // let propConfig = tool.GetArrData(\"type\", info.propId, util.propConfig);\r\n                // if (propConfig) {\r\n                //     AssistCtr.showToastTip(`恭喜获得${propConfig.name}道具`);\r\n                // }                                    \r\n                TrackMgr.tool_used({            \r\n                    tool_name : data.name,\r\n                    use_success: true,\r\n                    is_video_tool: true,\r\n                    level: \"第\"+util.userData.customs.big+\"关\",\r\n                })                    \r\n                this.flyAni(info.node);\r\n            },\r\n            fail: () => {             \r\n                let data = tool.GetArrData(\"type\", info.propId, util.propConfig);       \r\n                TrackMgr.tool_used({            \r\n                    tool_name : data.name,\r\n                    use_success: false,\r\n                    is_video_tool: true,\r\n                    level: \"第\"+util.userData.customs.big+\"关\",\r\n                })\r\n                this.closePage();\r\n            }\r\n        });\r\n    }\r\n\r\n    flyAni(node:cc.Node){        \r\n        cc.tween(this.bgNode).delay(1).to(0.3,{opacity:0}).call(()=>{\r\n            this.toolSpr.node.active = false;\r\n            AssistCtr.playAnimate(this.toolSpr.spriteFrame, this.toolSpr.node, node, ()=>{\r\n                cc.game.emit(NameTs.Game_PropItem_Update);\r\n                this.closePage();\r\n            })\r\n        }).start();\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}