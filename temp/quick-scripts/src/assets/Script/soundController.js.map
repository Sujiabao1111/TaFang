{"version":3,"sources":["assets\\Script\\soundController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import NameTs from \"./common/NameTs\";\nimport util from \"./util/util\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class soundController extends cc.Component {\n\n    private Map:Map<string,any> = new Map();\n\n    public static singleton:soundController = null;\n\n    public static isPlayMusic = false;\n\n    private bgmId;      //bgm创建id\n\n    onLoad(){\n\n        if(soundController.singleton===null){\n            soundController.singleton = this;\n        }else{\n            return;\n        }\n\n    }\n\n    /**\n     * 播放背景音乐\n     */\n    playBGM(){\n        if(util && util.soundSet){                  \n            if(util.soundSet.bgm != 0){\n                this.loadMusic(NameTs.Game_Music_BGM,(res)=>{\n                    this.bgmId = cc.audioEngine.play(res,true,1);\n                });\n            }\n            else if(cc.audioEngine.getState(soundController.singleton.bgmId) < 0){\n                this.loadMusic(NameTs.Game_Music_BGM,(res)=>{\n                    this.bgmId = cc.audioEngine.play(res,true,1);\n                });\n            }\n        }\n    }\n\n    /**\n     * 点击\n     */\n    clickAudio(){\n        if(!util.soundSet.sound)return;            \n\n        this.playSound(NameTs.Game_Music_Click, false, 1);\n    }\n\n    /**\n     * 播放死亡音效\n     */\n    playDeadAudio(){\n        if(!util.soundSet.sound)return;            \n\n        this.playSound(NameTs.Game_Monster_Dead, false, 1);\n    }\n\n    /**\n     * 播放音效\n     */\n    playMusic(name:string){\n        if(!util.soundSet.sound)return;            \n\n        this.playSound(name, false, 1);\n    }\n    \n\n\n    \n    /**\n     * 暂停背景音乐\n     */\n    stopBGM(){\n        cc.audioEngine.stop(this.bgmId);\n    }\n    /**\n     * 恢复背景音乐\n     */\n    resumeBGM(){\n        cc.audioEngine.resumeMusic();\n    }\n\n    /**\n     * 加载\n     * @param Url 地址\n     * @param call 回调\n     */\n    loadMusic(Url:string,call:Function){\n\n        let successFn = (data:cc.AudioClip)=>{\n            call(data);\n        }\n\n        if(this.Map.has(Url)){\n            let data = this.Map.get(Url);\n            successFn(data.audio);\n        }else{\n            cc.resources.load(Url,cc.AudioClip,(err,res:cc.AudioClip)=>{\n                if(err){\n                    console.error(err);\n                    return\n                }\n                this.Map.set(Url,{\n                    audio:res,\n                    id:null\n                });\n                successFn(res);\n            });\n        }\n        \n\n    }\n\n    /**\n     * 播放音效\n     * @param Url 地址\n     * @param loop 是否循环\n     * @param Volume 声音大小0-1\n     */\n    playSound(Url:string,loop:boolean,Volume:number){\n        if(!soundController.isPlayMusic)    return;\n\n        this.loadMusic(Url,(res)=>{\n            cc.audioEngine.play(res, loop,Volume);\n        });\n    }\n\n    /**\n     * 清理音效\n     * @param Url 地址\n     */\n    clearSound(Url:string){\n\n        if(this.Map.has(Url)){\n\n            let audio = this.Map.get(Url);\n\n            cc.audioEngine.uncache(audio.audio);\n        }\n    }\n\n    /**\n     * 清理所有音效\n     */\n    clearAllSound(){\n        cc.audioEngine.uncacheAll();\n    }\n\n    /**\n     * 暂停所有音效\n     */\n    stopAllSound(){\n        cc.audioEngine.stopAllEffects();\n    }\n\n    /**\n     * 暂停所有音效\n     */\n    resumeAllSound(){\n        cc.audioEngine.resumeAllEffects();\n    }\n\n}\n"]}