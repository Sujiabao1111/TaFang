{"version":3,"sources":["assets\\Script\\PageManage.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,0CAAsD;AACtD,0CAAqC;AACrC,0CAAqC;AAErC,oCAA+B;AACzB,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAwC,8BAAY;IAApD;QAAA,qEA4TC;QAzTG,sBAAsB;QACtB,iBAAW,GAAuB,IAAI,GAAG,EAAE,CAAC;QAE5C,QAAQ;QACR,cAAQ,GAAmB,IAAI,GAAG,EAAE,CAAC;QAQrC,OAAO;QACP,aAAO,GAAU,CAAC,CAAC;QAEnB,eAAe;QACP,aAAO,GAA4B,EAAE,CAAC;QAC9C,cAAc;QACN,aAAO,GAAU,IAAI,CAAC;;IAuSlC,CAAC;mBA5ToB,UAAU;IAwB3B,2BAAM,GAAN;QAEI,IAAG,YAAU,CAAC,SAAS,EAAC;YACpB,OAAO;SACV;aAAI;YACD,YAAU,CAAC,SAAS,GAAG,IAAI,CAAC;SAC/B;IAEL,CAAC;IAED;;OAEG;IACH,kCAAa,GAAb,UAAc,QAAe;QAEzB,IAAI,UAAU,GAAG,UAAC,IAAI;YAClB,OAAO,IAAI,IAAI,QAAQ,CAAC;QAC5B,CAAC,CAAA;QAED,OAAO,gBAAM,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;IAE/C,CAAC;IAED;;OAEG;IACF,oCAAe,GAAf,UAAgB,QAAe;QAE5B,IAAI,UAAU,GAAG,UAAC,IAAI;YAClB,OAAO,IAAI,IAAI,QAAQ,CAAC;QAC5B,CAAC,CAAA;QAED,OAAO,gBAAM,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;IAE7C,CAAC;IAED;;OAEG;IACF,oCAAe,GAAf,UAAgB,QAAe;QAE5B,IAAI,UAAU,GAAG,UAAC,IAAI;YAClB,OAAO,IAAI,IAAI,QAAQ,CAAC;QAC5B,CAAC,CAAA;QAED,OAAO,gBAAM,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;IAE7C,CAAC;IAGD;;;;OAIG;IACH,6BAAQ,GAAR,UAAS,IAAW,EAAC,IAAa;QAAlC,iBAsFC;QAtFoB,qBAAA,EAAA,WAAa;QAC9B,IAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC;YAAC,OAAO;QAErC,IAAI,SAAS,GAAY,UAAC,MAAc;YACpC,SAAS;YACT,IAAG,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC;gBAAC,OAAO;YAErC,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,EAAC,MAAM,CAAC,CAAC;YAEtC,IAAI,QAAQ,GAAG,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAChD,MAAM,CAAC,SAAS,CAAC,KAAI,CAAC,MAAM,CAAC,CAAC;YAC9B,yCAAyC;YACzC,IAAG,QAAQ,EAAC;gBACR,QAAQ,CAAC,IAAI,IAAE,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACnC,IAAG,QAAQ,CAAC,KAAK;oBAAC,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;aAC1C;YACD,IAAG,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAC;gBACxB,KAAI,CAAC,OAAO,EAAE,CAAC;aAClB;YACD,wCAAwC;YACxC,+CAA+C;YAC/C,2CAA2C;YAC3C,2CAA2C;YAC3C,wCAAwC;YACxC,sCAAsC;YACtC,IAAI;YAEJ,IAAG,cAAI,CAAC,UAAU,IAAI,kBAAS,CAAC,IAAI,IAAG,IAAI,IAAI,gBAAM,CAAC,QAAQ,CAAC,aAAa;mBACjE,IAAI,IAAI,gBAAM,CAAC,QAAQ,CAAC,SAAS;mBACjC,IAAI,IAAI,gBAAM,CAAC,QAAQ,CAAC,OAAO,IAAE,KAAI,CAAC,OAAO,GAAC,CAAC,EAAC;gBACvD,cAAI,CAAC,UAAU,GAAG,kBAAS,CAAC,IAAI,CAAC;gBACjC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAM,CAAC,SAAS,CAAC,CAAC;aAClC;YAED,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,EAAC,IAAI,CAAC,CAAC;YAChC,OAAO,QAAQ,CAAC;QACpB,CAAC,CAAA;QAGD,IAAG,IAAI,IAAI,gBAAM,CAAC,QAAQ,CAAC,aAAa,IAAE,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAC;YAElE,IAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,IAAE,CAAC,IAAI,KAAK,gBAAM,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAC;gBACzE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAC,IAAI,MAAA,EAAC,IAAI,MAAA,EAAC,CAAC,CAAC;gBAC/B,OAAO;aACV;YAED,IAAG,IAAI,CAAC,OAAO,KAAG,IAAI,EAAC;gBACnB,IAAI,IAAI,GAAG,IAAI,CAAC;gBAChB,IAAG,IAAI,CAAC,OAAO,CAAC,MAAM,GAAC,CAAC,EAAC;oBACrB,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;oBACvB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAC,KAAK,CAAC,CAAC;iBACnC;gBACD,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAC,IAAI,MAAA,EAAC,IAAI,MAAA,EAAC,CAAC,CAAC;gBAClC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;gBACpB,IAAG,IAAI,EAAC;oBACJ,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBAC3B;aACJ;YACD,IAAG,IAAI,CAAC,OAAO,KAAG,IAAI,EAAC;gBACnB,OAAO;aACV;YACD,IAAG,IAAI,CAAC,OAAO,IAAE,IAAI,EAAC;gBAClB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;aACvB;SACJ;QAKD,IAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,EAAC;YAEvB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,EAAC,yBAAyB,CAAC,CAAA;YAE9D,IAAI,MAAM,GAAW,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;YAE7D,SAAS,CAAC,MAAM,CAAC,CAAC;SAErB;aAAI;YACD,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,gBAAM,CAAC,OAAO,CAAC,IAAI,CAAC,EAAC,EAAE,CAAC,MAAM,EAAC,UAAC,GAAG,EAAC,GAAG;gBAErD,IAAI,MAAM,GAAG,EAAE,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;gBAEjC,SAAS,CAAC,MAAM,CAAC,CAAC;YAEtB,CAAC,CAAC,CAAA;SACL;IACL,CAAC;IAED,iBAAiB;IACjB,kCAAa,GAAb,UAAc,IAAW;QACrB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAC,KAAK,CAAC,CAAC;QACvC,KAAI,IAAI,CAAC,GAAG,CAAC,EAAC,CAAC,GAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;YACpC,IAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,IAAI,EAAC;gBAC5B,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;gBACzB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;gBAClB,MAAM;aACT;SACJ;QACD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAC,KAAK,CAAC,CAAC;IAE3C,CAAC;IAED;;;OAGG;IACH,gCAAW,GAAX,UAAY,IAAW;QACnB,EAAE,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAM,CAAC,OAAO,CAAC,IAAI,CAAC,EAAC,EAAE,CAAC,MAAM,CAAC,CAAC;IACzD,CAAC;IAED;;;;MAIE;IACF,8BAAS,GAAT,UAAU,IAAW,EAAC,GAAkB;QAAlB,oBAAA,EAAA,UAAkB;QACpC,IAAI,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAC,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC;QAC7D,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QAEpC,IAAI,GAAG,GAAU,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAC,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC;QAC7D,IAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAElC,IAAG,IAAI,IAAI,gBAAM,CAAC,QAAQ,CAAC,aAAa,IAAE,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAC;YAClE,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;YAC/B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;SACvB;aAAI;YACD,GAAG,GAAG,KAAK,CAAC;SACf;QAED,IAAG,GAAG,EAAC;YACH,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;SACtB;aAAI;YACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SAC1B;QAED,IAAG,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,EAAC;YAC9B,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,IAAG,IAAI,CAAC,OAAO,GAAG,CAAC,EAAC;gBAChB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;aACpB;SACJ;QACD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,EAAC,cAAc,CAAC,CAAA;QACxC,IAAG,cAAI,CAAC,UAAU,IAAE,kBAAS,CAAC,IAAI,IAAE,CAAC,cAAI,CAAC,MAAM;eACzC,UAAU,IAAI,gBAAM,CAAC,QAAQ,CAAC,aAAa;eAC3C,UAAU,IAAI,gBAAM,CAAC,QAAQ,CAAC,SAAS;eACvC,UAAU,IAAI,gBAAM,CAAC,QAAQ,CAAC,OAAO;eACrC,IAAI,CAAC,OAAO,IAAI,CAAC,EACxB;YACI,cAAI,CAAC,UAAU,GAAG,kBAAS,CAAC,KAAK,CAAC;YAClC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAM,CAAC,WAAW,CAAC,CAAC;SACpC;IAEL,CAAC;IAED;;OAEG;IACH,iCAAY,GAAZ;QACI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAC,cAAc,CAAC,CAAA;QAC/C,IAAG,IAAI,CAAC,OAAO,CAAC,MAAM,GAAC,CAAC,IAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAC;YACtC,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YAC3B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;SAC5B;IAEL,CAAC;IAED;;;OAGG;IACF,6BAAQ,GAAR,UAAS,IAAW;QACjB,IAAI,GAAG,GAAU,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAC,IAAI,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC;QAC7D,IAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAClC,IAAG,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,EAAC;YACvB,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;SACjC;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAED;;MAEE;IACF,4BAAO,GAAP,UAAQ,IAAY;QAChB,IAAG,IAAI,CAAC,IAAI,IAAI,kBAAkB,EAAC;YAC/B,OAAO;SACV;QACD,IAAI,EAAE,GAAW,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QAC3C,IAAI,OAAO,GAAW,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QAErD,IAAG,EAAE,EAAC;YACF,EAAE,CAAC,OAAO,GAAG,CAAC,CAAC;YACf,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAC,EAAC,OAAO,EAAC,GAAG,EAAC,CAAC,CAAC,KAAK,EAAE,CAAC;SAC7C;QACD,IAAG,OAAO,EAAC;YACP,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC;YAClB,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,EAAC,EAAC,KAAK,EAAC,CAAC,EAAC,CAAC,CAAC,KAAK,EAAE,CAAC;SAC9C;IACL,CAAC;IACD;;;OAGG;IACH,6BAAQ,GAAR,UAAS,IAAY;QAArB,iBAqBC;QAnBG,IAAG,IAAI,EAAC;YACJ,IAAG,IAAI,CAAC,IAAI,IAAI,kBAAkB,IAAE,IAAI,CAAC,IAAI,IAAI,aAAa,IAAE,IAAI,CAAC,IAAI,IAAI,qBAAqB,EAAC;gBAC/F,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;gBACvB,OAAO;aACV;YAED,IAAG,IAAI,CAAC,IAAI,IAAI,EAAE,EAAC;gBACf,IAAI,EAAE,GAAW,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;gBAC3C,IAAI,OAAO,GAAW,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;gBACrD,IAAG,EAAE;oBAAC,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAC,EAAC,OAAO,EAAC,CAAC,EAAC,CAAC,CAAC,KAAK,EAAE,CAAC;gBAC9C,IAAG,OAAO;oBAAC,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,EAAC,EAAC,KAAK,EAAC,CAAC,EAAC,CAAC,CAAC,KAAK,EAAE,CAAC;gBACtD,IAAI,CAAC,YAAY,CAAC;oBACd,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;gBAC3B,CAAC,EAAC,EAAE,CAAC,CAAC;aACT;iBACG;gBACA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;aAC1B;SACJ;IACL,CAAC;IAED;;OAEG;IACH,gCAAW,GAAX,UAAY,IAAY,EAAC,MAAqB;QAArB,uBAAA,EAAA,aAAqB;QAC1C,IAAG,IAAI,EAAC;YACJ,IAAI,CAAC,OAAO,IAAE,IAAI,CAAC,OAAO,EAAE,CAAC;YAC7B,IAAI,CAAC,gBAAgB,IAAE,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAC/C,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YAC3D,IAAG,MAAM;gBAAC,IAAI,CAAC,YAAY,EAAE,CAAC;SACjC;IACL,CAAC;;IA/Sa,oBAAS,GAAc,IAAI,CAAC;IAZzB,UAAU;QAD9B,OAAO;OACa,UAAU,CA4T9B;IAAD,iBAAC;CA5TD,AA4TC,CA5TuC,EAAE,CAAC,SAAS,GA4TnD;kBA5ToB,UAAU","file":"","sourceRoot":"/","sourcesContent":["import { gameState, propType } from \"./common/faceTs\";\nimport NameTs from \"./common/NameTs\";\nimport pageTs from \"./common/pageTs\";\nimport tool from \"./util/tool\";\nimport util from \"./util/util\";\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class PageManage extends cc.Component {\n\n    \n    //打开的窗口中是否有重复的，如果有则不打开\n    pageOpenArr:Map<string,string>  = new Map();\n\n    //打开的预制体\n    pageOpen:Map<string,any> = new Map();\n\n    //父类\n    parent:cc.Node;\n\n    public static singleton:PageManage = null;\n\n\n    //打开的数量\n    openNum:number = 0;\n\n    /**需要打开页面的数组 */\n    private pageArr:{name:string,data:any}[] = [];\n    /**现在打开的是哪个 */\n    private nowPage:string = null;\n    \n\n    onLoad(){\n\n        if(PageManage.singleton){\n            return;\n        }else{\n            PageManage.singleton = this;\n        }\n\n    }    \n\n    /**\n     * 检查是否在停止页面上\n     */\n    checkStopGame(pageName:string){\n\n        let checkAdult = (name) => {\n            return name == pageName;\n        }\n\n        return pageTs.stopGamePage.some(checkAdult)\n\n    }\n\n    /**\n     * 检查是否能二级弹窗\n     */\n     checkTwoPopGame(pageName:string){\n\n        let checkAdult = (name) => {\n            return name == pageName;\n        }\n\n        return pageTs.twoPopPage.some(checkAdult)\n\n    }\n\n    /**\n     * 检查是否能最高弹窗\n     */\n     checkTopPopGame(pageName:string){\n\n        let checkAdult = (name) => {\n            return name == pageName;\n        }\n\n        return pageTs.topPopPage.some(checkAdult)\n\n    }\n    \n\n    /**\n     * 打开哪个页面\n     * @param name 哪个\n     * @param data 数据\n     */\n    showPage(name:string,data:any=null){\n        if(this.pageOpenArr.has(name))return;\n\n        let successFn:Function = (Prefab:cc.Node)=>{            \n            //如果有则不打开\n            if(this.pageOpenArr.has(name))return;\n\n            this.pageOpen.set(Prefab.name,Prefab);\n\n            let PrefabTs = Prefab.getComponent(Prefab.name);\n            Prefab.setParent(this.parent);\n            // this.pageOpen.set(Prefab.name,Prefab);\n            if(PrefabTs){\n                PrefabTs.init&&PrefabTs.init(data);\n                if(PrefabTs.isAni)this.showAni(Prefab);\n            }\n            if(this.checkStopGame(name)){\n                this.openNum++;\n            }\n            // if(util.levelState != gameState.stop \n            //     && name != pageTs.pageName.GameAdLoading\n            //     && name != pageTs.pageName.GameStart\n            //     && name != pageTs.pageName.GameEnd){\n            //     util.levelState = gameState.stop;\n            //     cc.game.emit(NameTs.Game_Stop);\n            // }\n\n            if(util.levelState != gameState.stop&& name != pageTs.pageName.GameAdLoading\n                    && name != pageTs.pageName.GameStart\n                    && name != pageTs.pageName.GameEnd&&this.openNum>0){\n                util.levelState = gameState.stop;\n                cc.game.emit(NameTs.Game_Stop);\n            }\n\n            this.pageOpenArr.set(name,name);\n            return PrefabTs;\n        }\n        \n\n        if(name != pageTs.pageName.GameAdLoading&&!this.checkTwoPopGame(name)){\n\n            if(this.checkTopPopGame(this.nowPage)&&(name !== pageTs.pageName.GameWallet)){\n                this.pageArr.push({name,data});\n                return;\n            }\n\n            if(this.nowPage!==name){\n                let item = null;\n                if(this.pageArr.length>0){\n                    item = this.pageArr[0];\n                    this.closePage(item.name,false);\n                }\n                this.pageArr.unshift({name,data});\n                this.nowPage = null;\n                if(item){\n                    this.pageArr.push(item);\n                }\n            }\n            if(this.nowPage!==null){\n                return;\n            }\n            if(this.nowPage==null){\n                this.nowPage = name;\n            }\n        }\n        \n\n        \n\n        if(this.pageOpen.has(name)){\n\n            console.log(this.pageOpen.get(name),'this.pageOpen.get(name)')\n\n            let Prefab:cc.Node = cc.instantiate(this.pageOpen.get(name));            \n\n            successFn(Prefab);\n\n        }else{\n            cc.resources.load(pageTs.pageUrl[name],cc.Prefab,(err,res)=>{\n\n                let Prefab = cc.instantiate(res);                                \n    \n                successFn(Prefab);\n    \n            })\n        }\n    }\n\n    /**删除数组指定的页面名字 */\n    delectPageArr(name:string){\n        console.log(this.pageArr.length,'删除前');\n        for(let i = 0;i<this.pageArr.length;i++){\n            if(this.pageArr[i].name == name){\n                this.pageArr.splice(i,1);\n                console.log(\"删除掉\")\n                break;\n            }\n        }\n        console.log(this.pageArr.length,'删除后');\n\n    }\n\n    /**\n     * 预加载\n     * @param name 哪个页面\n     */\n    preloadPage(name:string){\n        cc.resources.preload(pageTs.pageUrl[name],cc.Prefab);\n    }\n\n    /**\n     * 关闭哪个页面\n     * @param name 哪个\n     * @param ani 是否有动画\n    */\n    closePage(name:string,ani:boolean = true){            \n        let deleteName = name.replace(name[0],name[0].toUpperCase());\n        this.pageOpenArr.delete(deleteName);\n\n        let str:string = name.replace(name[0],name[0].toLowerCase());\n        let node = this.pageOpen.get(str);\n        \n        if(name != pageTs.pageName.GameAdLoading&&!this.checkTwoPopGame(name)){\n            this.delectPageArr(deleteName);\n            this.nowPage = null;\n        }else{\n            ani = false;\n        }\n\n        if(ani){\n            this.closeAni(node)\n        }else{\n            this.destroyPage(node);\n        }\n\n        if(this.checkStopGame(deleteName)){\n            this.openNum--;\n            if(this.openNum < 0){\n                this.openNum = 0;\n            }\n        }\n        console.log(this.openNum,'this.openNum')\n        if(util.levelState==gameState.stop&&!util.isStop \n            && deleteName != pageTs.pageName.GameAdLoading \n            && deleteName != pageTs.pageName.GameStart\n            && deleteName != pageTs.pageName.GameEnd\n            && this.openNum == 0)\n        {\n            util.levelState = gameState.start;\n            cc.game.emit(NameTs.Game_Resume);\n        }\n        \n    }\n\n    /**\n     * 展现下一个页面\n     */\n    showNextPage(){\n        console.log(this.pageArr.length,'this.pageArr')\n        if(this.pageArr.length>0&&this.pageArr[0]){\n            let item = this.pageArr[0];\n            this.showPage(item.name,item.data);\n            this.pageArr.splice(0,1);\n        }\n\n    }\n\n    /**\n     * 查找当前打开的页面\n     * @param name 页面名字\n     */\n     findPage(name:string){\n        let str:string = name.replace(name[0],name[0].toLowerCase());\n        let node = this.pageOpen.get(str);        \n        if(node && node.name != \"\"){            \n            return this.pageOpen.get(str);\n        }\n        return null;\n    }\n    \n    /**开场动画 \n     * @param node 节点\n    */\n    showAni(node:cc.Node){\n        if(node.name == `gameWalletRecord`){\n            return;\n        }\n        let bg:cc.Node = node.getChildByName(\"bg\");\n        let conetnt:cc.Node = node.getChildByName(\"content\");\n        \n        if(bg){\n            bg.opacity = 0;\n            cc.tween(bg).to(.1,{opacity:150}).start();\n        }\n        if(conetnt){\n            conetnt.scale = 0;\n            cc.tween(conetnt).to(.2,{scale:1}).start();\n        }\n    }\n    /**\n     * 关闭动画\n     * @param node 节点\n     */\n    closeAni(node:cc.Node){\n\n        if(node){\n            if(node.name == `gameWalletRecord`||node.name == `gameKingPao`||node.name == `gameKingPaoProgress`){\n                this.destroyPage(node);\n                return;\n            }\n\n            if(node.name != \"\"){\n                let bg:cc.Node = node.getChildByName(\"bg\");\n                let conetnt:cc.Node = node.getChildByName(\"content\");\n                if(bg)cc.tween(bg).to(.2,{opacity:0}).start();\n                if(conetnt)cc.tween(conetnt).to(.1,{scale:0}).start();\n                this.scheduleOnce(()=>{\n                    this.destroyPage(node);\n                },.2);\n            }\n            else{\n                this.destroyPage(node);\n            }\n        }\n    }\n\n    /**\n     * 销毁页面\n     */\n    destroyPage(node:cc.Node,isShow:boolean = true){\n        if(node){\n            node.destroy&&node.destroy();\n            node.removeFromParent&&node.removeFromParent();\n            cc.assetManager.releaseAsset(this.pageOpen.get(node.name));\n            if(isShow)this.showNextPage();\n        }\n    }\n}\n"]}