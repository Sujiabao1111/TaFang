{"version":3,"sources":["assets\\Script\\ui\\autoBtn.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { AssistCtr } from \"../Assist/AssistCtr\";\nimport { AdPosition } from \"../common/AdPosition\";\nimport { propType } from \"../common/faceTs\";\nimport NameTs from \"../common/NameTs\";\nimport pageTs from \"../common/pageTs\";\nimport { UrlConst } from \"../server/UrlConst\";\nimport AdController from \"../server/xmsdk_cocos/AD/AdController\";\nimport soundController from \"../soundController\";\nimport TrackMgr from \"../TrackMgr/TrackMgr\";\nimport tool from \"../util/tool\";\nimport util from \"../util/util\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class autoBtn extends cc.Component {\n\n    //时间\n    @property(cc.Label)\n    timeLabel: cc.Label = null;\n    \n    //锁\n    @property(cc.Node)\n    lockIcon: cc.Node = null;\n\n    //手\n    @property(cc.Node)\n    hand: cc.Node = null;\n\n    // LIFE-CYCLE CALLBACKS:\n\n    private initData:any;\n\n    //是否锁着\n    private isLock:boolean;\n\n    private time:number = 10;\n\n    onLoad () {\n\n        cc.game.on(NameTs.Game_Start,res=>{\n            if(util.userData.customs.big == this.initData.level&&this.isLock){\n                util.userData.autoProp = 0;\n                this.setState();\n            }\n        },this);\n    }    \n\n    /**设置状态 */\n    setState(){\n        if(util.userData.customs.big>=this.initData.level){\n            this.node.color = cc.color(255,255,255,255);\n            this.lockIcon.active  = false;\n            this.isLock = false;\n        }else{\n            this.node.color = cc.color(107,107,107,255);\n            this.lockIcon.active  = true;\n            this.isLock = true;\n        }\n        \n        if(util.userData.autoProp==0){\n            this.hand.active = true;\n            this.time = 10;\n        }\n\n    }\n\n    start () {\n        if(util && util.propData){\n            for(let i = 0;i<util.propData.length;i++){\n                let item = util.propData[i];\n                if(item.propIssueDetailList[0].propsId==propType.auto){\n                    this.initData = item.propIssueDetailList[0];\n                    break;\n                }\n            }\n            this.setState();\n        }       \n    }\n\n    /**\n     * 使用道具\n     */\n    useBtn(){\n        soundController.singleton.clickAudio();\n        TrackMgr.AppClick({\n            app_page_title: \"首页\",\n            app_ck_module: \"自动合成按钮\",\n            app_exposure_type: \"icon\",\n        });\n        if(this.timeLabel.node.getParent().active){\n            AssistCtr.showToastTip(\"正在使用中!\");\n            return;\n        }\n        if(this.isLock){\n            AssistCtr.showToastTip(this.initData.level+\"关解锁!\");\n            return;\n        }\n        let isVideo:boolean = true;\n        if(util.userData.prop[propType.auto-1].num>0||util.userData.autoProp==0){\n            isVideo = false\n        }\n\n        let successFn = ()=>{\n            util.UseProp(this.initData.propsId);\n            // this.setData();\n            console.log(\"使用道具\", this.initData.propsId);\n            this.sendMTrack(true, isVideo);\n            util.gamePropNum += 1;\n            this.djs();\n            util.userData.autoProp = 1;\n            this.closeHand();\n            util.setStorage(util.localDiary.autoProp,util.userData.autoProp);\n        }\n        console.log(isVideo,'isVideo')\n        if(isVideo){\n            AdController.loadAd(AdPosition.autoVideo,()=>{\n                util.post({\n                    url: UrlConst.getUseProp,\n                    data: { propId: this.initData.propsId },\n                    success: () => {\n                        if(!this.isValid){\n                            return;\n                        }\n                        successFn();\n                    },\n                    fail: () => {\n                        this.sendMTrack(false, false);\n                    }\n                });\n            }, () => {\n                AssistCtr.showToastTip(\"加载视频失败，请稍后！\");\n            });\n        }else{\n            successFn();\n        }\n\n        \n\n    }\n\n    /**倒计时 */\n    djs(){\n        this.timeLabel.node.getParent().active = true;\n        this.schedule(()=>{\n            let time:number = util.userData.prop[propType.auto-1].time;\n            if(!time){\n                this.unscheduleAllCallbacks();\n                this.timeLabel.node.getParent().active = false;\n                return;\n            }\n            this.timeLabel.string = tool.changeTime(time);\n        },1);\n\n    }\n\n    update(dt){\n\n        if(this.time>0){\n            this.time-=dt;\n            if(this.time<0){\n                this.time = 0;\n                this.closeHand();\n            }\n        }\n        \n    }\n\n    /**关闭手势 */\n    closeHand(){\n        this.hand.active = false;\n        if(util.userData.autoProp==2){\n            util.setStorage(util.localDiary.autoProp,2);\n        }\n    }\n\n    /**是否 */\n    sendMTrack(isSuccess: boolean, isVideo: boolean) {\n\n        let data = tool.GetArrData(\"type\", this.initData.propsId, util.propConfig);\n\n        TrackMgr.tool_used({\n            tool_name: data.name,\n            use_success: isSuccess,\n            is_video_tool: isVideo,\n            level: \"第\" + util.userData.customs.big + \"关\",\n        })\n\n    }\n\n    // update (dt) {}\n}\n"]}