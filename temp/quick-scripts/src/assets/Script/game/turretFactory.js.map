{"version":3,"sources":["assets\\Script\\game\\turretFactory.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { AdPosition } from \"../common/AdPosition\";\nimport { bulletInfo, gameState, thingType, turretInfo } from \"../common/faceTs\";\nimport NameTs from \"../common/NameTs\";\nimport TrackMgr from \"../TrackMgr/TrackMgr\";\nimport tool from \"../util/tool\";\nimport util from \"../util/util\";\nimport turret from \"./turret/turret\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class turretFactiory extends cc.Component {\n\n \n\n    initData;//初始化数据\n\n    turretData:turretInfo; //炮台的数据\n\n    private initPos:cc.Vec2;//出生在哪里\n\n    //攻击目标\n    attackData:any;\n\n    //子弹属性\n\n    bullet:bulletInfo;\n\n    //是否在拿着\n    isTouch:boolean;\n\n    //炮头\n    pao:cc.Node;\n\n    //存储当前相同等级的炮塔\n    sameLevelTurret:any[];\n\n    //touchid\n    touchId:number;\n\n    start () {\n\n    }\n\n    onLoad(){\n        //获取存放地址\n        if(this.initData.no){\n            this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this);\n            this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this);\n            this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this);\n            this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this);\n\n\n            //拿起\n            cc.game.on(NameTs.Game_Turret_PickUp,(res)=>{\n                if(res.level !== this.initData.level){\n                    this.node.opacity = 150;\n                }\n            },this);\n\n            //放下\n            cc.game.on(NameTs.Game_Turret_PutDown,(res)=>{\n                if(res.level !== this.initData.level){\n                    this.node.opacity = 255;\n                }\n\n            },this);\n\n        }\n        // this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this);\n        \n        // this.touchArr = new Map();\n\n        //监听该目标怪兽死亡后重设子弹目标\n        cc.game.on(NameTs.Game_Monster_Killed,(data)=>{\n            //如果没有目标就退出\n            if(this.bullet.targetId==null){\n                this.attackData = null;\n                return;\n            }\n\n            if(data.id==this.bullet.targetId){\n                this.bullet.targetId = null;\n                this.attackData = null;\n                this.stopAttack();\n            }\n\n        },this);\n\n        \n\n        //监听游戏暂停\n        cc.game.on(NameTs.Game_Stop,()=>{\n            \n            this.stopAttack();\n\n        },this);\n\n        //监听游戏继续\n        cc.game.on(NameTs.Game_Resume,()=>{\n            \n            this.resumeAttack();\n\n        },this);\n        \n    }\n\n    /**\n     * 触碰开始\n     * @param event \n     */\n    private touchStart(event){\n        this.touchId = event.getID();\n        if(util.touchId&&util.touchId !== this.touchId){return}\n        util.touchId = this.touchId;\n        this.PickUp();\n        this.isTouch = true;\n        this.node.zIndex = 99;\n        this.bullet.targetId = null;\n        this.attackData = null;\n        this.stopAttack();\n        this.pao.angle = 0;\n        this.initPos = this.node.getPosition();\n    }\n\n    /**\n     * 触碰移动\n     * @param event \n     */\n    private touchMove(event){\n        if(util.touchId !== this.touchId){return}\n        let movePos:cc.Vec2 = event.getDelta();\n        this.node.x +=movePos.x;\n        this.node.y +=movePos.y; \n    }\n\n    /**\n     * 触碰结束\n     * @param event \n     */\n    private touchEnd(event){\n        if(util.touchId !== this.touchId){return}\n        this.isTouch = false;\n        this.PutDown();\n        util.touchId = null;\n        this.carshPlace(()=>{\n            this.node.setPosition(this.initPos);\n            this.node.zIndex = 0;\n            // cc.tween(this.node).to(.2,{x:this.initPos.x,y:this.initPos.y}).call(()=>{\n                \n            // }).start();\n        })\n    }\n\n    /**\n     * 检查里面在哪个里面\n     * @param call 回调\n     */\n\n    carshPlace(call:Function){\n\n        let pos:cc.Vec2 = this.node.getPosition();\n\n        util.checkTouchPool(pos,(num)=>{\n            if(num&&num!==this.initData.no){\n                if(num==100){\n                    if(util.userData.noviceGuide==2){\n                        call();\n                    }else{\n                        this.recycleFn();\n                    }\n                }else{\n                    if(util.userData.noviceGuide==2&&num>2){\n                        call();\n                    }else{\n                        this.GetType(num,call);\n                    }\n                }\n            }else{\n                call();\n            }\n\n        });\n\n    }\n\n    /**\n     * 判断是交换还是升级\n     * @param no 第几个\n     * @param call 回调\n     */\n    GetType(no:number,call:Function=()=>{}){\n        if(!this.initData.no||!no){\n            call();\n            return;\n        }\n        //获取炮台位置的位置\n        let otherData = util.GetPoolData(no);\n        let otherPlaceData = util.GetPlaceData(no);\n        let otherPos:cc.Vec2 = cc.Vec2.clone(otherPlaceData.pos);\n        if(otherData.level==-1){\n            console.log(\"找个空位坐下\");\n            if(!util.checkNoExist(no)){\n                call();\n                console.log(\"未解锁\");\n                return;\n            }\n            util.savePool(this.initData.no);\n            this.node.setPosition(otherPos);\n            util.savePool(no,this.initData.level);\n            //删除以前的\n            cc.game.emit(NameTs.Game_Turret_Killed,{no:this.initData.no});\n            this.createLevelBg(no,this.initData.level);\n            util.GlobalMap.delete(\"turret_\"+this.initData.no);\n            this.initData.no = no;\n            //更新现在的\n            util.GlobalMap.set(\"turret_\"+no,this.node);\n            this.node.zIndex = 0;\n        }else{\n            \n            let otherNode:cc.Node = util.GlobalMap.get(\"turret_\"+no);\n            //升级\n            if(otherData.level==this.initData.level){\n\n                if(!util.checkUpdateLevel(this.initData.level+1)){\n                    console.error(\"等级超过最大等级了!\");\n                    call();\n                    return \n                }\n                //合成奖励\n                let coin:number = util.GetBehaviorRewardVo(5);\n\n                if(util.userData.noviceGuide == 2||(util.userData.noviceGuide == 3&&util.checkTestB(NameTs.new_hand_test))){\n                   let CoinParent:cc.Node = cc.director.getScene().getChildByName('Canvas');\n                   cc.game.emit(NameTs.Game_Effect_coin,{node:this.node,value:coin,num:5,parent:CoinParent});\n                }else{\n                    cc.game.emit(NameTs.Game_Effect_coin,{node:this.node,value:coin,num:5});\n                }\n                util.addTermCoin(coin);\n                \n                util.userData.compoundTimes+=1;\n                util.userData.localCompoundTime+=1;\n                cc.game.emit(NameTs.Game_Task_updata);\n                util.userData.synthesis_times+=1;\n                util.userData.synthesis_All+=1;\n                util.savePool(this.initData.no,null);\n                let pos:cc.Vec2 = cc.Vec2.clone(otherPos);\n                this.node.setPosition(pos);\n                otherNode.zIndex = this.node.zIndex = 99;\n                cc.game.emit(NameTs.Game_Turret_Killed,{no});\n                cc.game.emit(NameTs.Game_Turret_Killed,{no:this.initData.no});\n                cc.tween(otherNode).by(.1,{x:50}).by(.1,{x:-50}).call(()=>{\n                    otherNode.zIndex = 0;\n                    cc.game.emit(NameTs.Game_Turret_Killed,{node:otherNode,no:null});\n                }).start();\n                //删除以前的\n                util.GlobalMap.delete(\"turret_\"+this.initData.no);\n                //更新现在的\n                util.GlobalMap.set(\"turret_\"+no,this.node);\n                this.upLevel(no);\n                cc.tween(this.node).by(.1,{x:-50}).by(.1,{x:50}).call(()=>{\n                    this.node.zIndex = 0;\n                }).start();\n\n                //预加载解锁炮塔信息流\n                // if(!util.adPreObj[AdPosition.UnlcokTurretView]&&util.chekPoolHaveTwo()){\n                //     util.preloadAd(AdPosition.UnlcokTurretView,true);\n                // }\n\n            }else{ //交换\n                let selfNo:number = this.initData.no;\n                let selfPlaceData = util.GetPlaceData(selfNo);\n                let selfPos:cc.Vec2 = cc.Vec2.clone(selfPlaceData.pos);\n                //交换位置\n                otherNode.setPosition(selfPos.x,selfPos.y);\n                this.node.setPosition(otherPos.x,otherPos.y);\n                //保存数据\n                util.savePool(selfNo,otherData.level);\n                util.savePool(no,this.initData.level);\n                \n                //修改位置no\n                otherNode.getComponent(\"turret\").initData.no = selfNo;\n                this.initData.no = no;\n                //删除以前的\n                util.GlobalMap.set(\"turret_\"+selfNo,otherNode);\n                //更新现在的\n                util.GlobalMap.set(\"turret_\"+no,this.node);\n                this.node.zIndex = otherNode.zIndex = 0;\n                \n                //删除以前的\n                cc.game.emit(NameTs.Game_Turret_Killed,{no:this.initData.no});\n                this.createLevelBg(no,otherData.level);\n                cc.game.emit(NameTs.Game_Turret_Killed,{no:selfNo});\n                otherNode.getComponent(\"turret\").createLevelBg(selfNo,this.initData.level);\n            }\n\n\n        }\n    }\n\n    /**设置名字 */\n    setName() {}\n\n    /**设置数据 */\n    setData(data){\n        this.init(data);\n    }\n    init(data){};\n\n    /**\n     * 升级\n     */\n    upLevel(no){}\n\n    /**监听是否有怪 */\n    update(dt){\n        if(util.levelState !== gameState.start)return\n        //如果有就退出\n        if(this.isTouch)return;\n        let pos:cc.Vec2 = this.node.getPosition();\n        if(this.attackData){\n            this.setPao();\n            if(this.attackData&&this.attackData.isClose){\n                if(util.checkMonsterClose({pos,id:this.attackData.id,distanceNum:this.initData.no?250:375}))return;\n            }else{\n                let newData = util.getCloseMonster(pos,this.initData.no?250:375);\n                if(this.attackData&&newData.id == this.attackData.id){\n                    return;\n                }else{\n                    // this.attackFn();\n                }\n            }\n        }\n        this.attackData = util.getCloseMonster(pos,this.initData.no?250:375);\n\n        if(!this.attackData)return;\n        this.bullet.targetId = this.attackData.id;\n        this.attackFn();\n\n    }\n\n    /**设置目标 */\n    setTarget(){\n\n        \n\n    }\n    \n    /**\n     * 攻击\n     */\n    attackFn(){}\n\n    /**\n     * 回收\n     */\n    recycleFn(){\n\n        util.savePool(this.initData.no,null);\n        util.GlobalMap.delete(\"turret_\"+this.initData.no);\n        cc.game.emit(NameTs.Game_Turret_Killed,{node:this.node,no:this.initData.no});\n        TrackMgr.AppClick({\n            app_page_title: \"首页\",\n            app_ck_module: \"回收炮塔\",\n            app_exposure_type: \"banner\",\n        });\n    }\n\n    /**\n     * 拿起\n     */\n\n    PickUp(){\n\n        //相同等级的炮台数据\n        // this.sameLevelTurret = util.getPoolSameLevelTurret(this.initData.level)\n        this.sameLevelTurret = util.getPoolSameLevelTurret(this.initData.level)\n        if(this.sameLevelTurret){\n            for(let i = 0;i<this.sameLevelTurret.length;i++){\n                cc.game.emit(NameTs.Game_Same_Place_PickUp,{id:this.sameLevelTurret[i].no});\n            }\n        }\n\n        cc.game.emit(NameTs.Game_Turret_PickUp,{id:this.initData.no,level:this.initData.level,host:this.initData.no});\n\n\n    }\n\n    /**\n     * 放下\n     */\n\n    PutDown(){\n\n        // this.sameLevelTurret.forEach((item:any)=>{\n\n\n        // });\n\n        if(this.sameLevelTurret){\n            for(let i = 0;i<this.sameLevelTurret.length;i++){\n                cc.game.emit(NameTs.Game_Same_Place_PutDown,{id:this.sameLevelTurret[i].no});\n            }\n        }\n        \n        cc.game.emit(NameTs.Game_Turret_PutDown,{id:this.initData.no,level:this.initData.level});\n\n        this.sameLevelTurret = null;\n\n    }\n    /**两点角度 */\n    GetAngle():number{\n\n        let monsetrName = util.userData.customs.big+\"-\"+util.userData.customs.small+\"_Monster_\"+this.bullet.targetId;\n        let targetNode:cc.Node= util.MonsterMap.get(monsetrName);\n\n        if(!targetNode){\n            this.bullet.targetId = null;\n            this.attackData = null;\n            return 0;\n        }\n\n\n        let targetPos:cc.Vec2 = cc.Vec2.clone(targetNode.getPosition());\n\n        targetPos = targetNode.parent.convertToWorldSpaceAR(targetPos);\n        targetPos = this.node.parent.convertToNodeSpaceAR(targetPos);\n\n        let angle:number = tool.GetPosAngle(this.bullet.initPos,targetPos);\n\n        \n       \n        return angle;\n    }\n\n    /**设置炮塔角度 */\n    setPao(){};\n\n    /**停止攻击 */\n    stopAttack(){}\n    /**恢复攻击 */\n    resumeAttack(){}\n\n    /**\n     * 加载图片\n     */\n    loadSpine(spine:sp.Skeleton,name:string){\n        let mouthName:string = this.turretData.mouthName;\n        cc.resources.load(\"spine/turret/\"+this.turretData.DynamicResources+\"/\"+name+\"/\"+(name==\"mouth\"?mouthName:this.turretData.spineName),sp.SkeletonData, (error, sp:sp.SkeletonData) => {\n            spine.skeletonData = sp;\n            spine.setAnimation(0,\"animation\",false);\n        });\n    }\n\n    /**\n     * 创建等级背景板\n     */\n    createLevelBg(no:number,level:number){\n        cc.game.emit(NameTs.Game_LevelBg_Creator,{node:this.node,no});\n        cc.game.emit(NameTs.Game_LevelLabel_Creator,{node:this.node,no,level:this.initData.level});\n\n    }\n}\n"]}