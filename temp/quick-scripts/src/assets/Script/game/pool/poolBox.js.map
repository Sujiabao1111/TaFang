{"version":3,"sources":["assets\\Script\\game\\pool\\poolBox.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import baseTs from \"../../base/baseTs\";\nimport { thingType } from \"../../common/faceTs\";\nimport NameTs from \"../../common/NameTs\";\nimport { UrlConst } from \"../../server/UrlConst\";\nimport XMSDK from \"../../server/xmsdk_cocos/XMSDK\";\nimport util from \"../../util/util\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class poolBox extends baseTs {\n    \n\n    @property({type:cc.Prefab,displayName:\"怪物道路\"})\n    private monsterWayPre:cc.Prefab = null;\n\n    @property({type:cc.Prefab,displayName:\"炮塔位置\"})\n    private PlaceItemPre:cc.Prefab = null;\n    \n    @property({type:cc.Prefab,displayName:\"开始位置\"})\n    private startPointPre:cc.Prefab = null;\n\n    @property({type:cc.Prefab,displayName:\"结束位置\"})\n    private endPointPre:cc.Prefab = null;\n\n\n\n    private turretNo:number=0;\n\n    onLoad () {\n        \n        this.init();\n    }\n\n    start () {\n        \n        \n\n    }\n\n    public init(){\n\n        this.loadMap();\n\n\n    }\n    //加载地图\n    loadMap(){\n        \n        let mapData = util.GetCustomsMap();\n        if(!mapData){\n            console.error(\"加载地图失败\");\n            return;\n        }\n        //设置地图大小\n        util.mapSize.width = cc.winSize.width;\n\n        //设置格子大小\n        util.mapSize.grid = util.mapSize.width/mapData.xLen;\n        //设置初始格子位置\n        util.mapSize.startGridPos = {\n            x:-util.mapSize.grid*mapData.xLen/2+util.mapSize.grid/2,\n            y:util.mapSize.grid*mapData.yLen/2-util.mapSize.grid/2\n        }\n        for(let i = 0;i<mapData.map.length;i++){\n            let y:number = i;\n            for(let j = 0;j<mapData.map[i].length;j++){\n                let x:number = j;\n\t\t\t\t//console.log('make---------------------------:' +mapData.map[i][j] )\n               this.loadType({x,y,type:mapData.map[i][j]});\n            }\n        }\n\n        \n\n    }\n\n    \n\n    /**\n     * 加载类型\n     */\n\n    loadType(data:any){\n        let str = {\n            node:null,\n            name:null,\n            pos:null,\n            data:null\n        }\n\n        if(data.type!==0){\n            str.pos ={\n                x:util.mapSize.startGridPos.x+data.x*util.mapSize.grid,\n                y:util.mapSize.startGridPos.y-data.y*util.mapSize.grid\n            }\n        }\n        \n        switch(data.type){\n\n            case 0:\n                break;\n            case 1://炮塔位置\n                str.node = cc.instantiate(this.PlaceItemPre);\n                str.name = \"placeItem\";\n                this.turretNo++;\n                util.levelMap.push({\n                    x:data.x,\n                    y:data.y,\n                    type:thingType.turret,\n                    no:this.turretNo,\n                    pos:str.pos\n                });\n                str.data = {id:this.turretNo};\n\n                // if(!util.checkNoExist(this.turretNo)){\n                //     util.userData.pool.push({no:this.turretNo,level:-1,state:this.turretNo<9?1:0});\n                // }\n                break;\n            case 2://开始位置\n                // str.node = cc.instantiate(this.startPointPre);\n                // str.name = \"startPoint\";\n                break;\n            case 3://结束位置\n                // str.node = cc.instantiate(this.endPointPre);\n                // str.name = \"endPoint\";\n                break;\n            case 4://怪物道路\n                // str.node = cc.instantiate(this.monsterWayPre);\n                // str.name = \"monsterWay\";\n                break;\n        }\n\n        if(str.name){\n            str.node.setPosition(\n                util.mapSize.startGridPos.x+data.x*util.mapSize.grid,\n                util.mapSize.startGridPos.y-data.y*util.mapSize.grid,\n            )\n            str.node.setParent(this.node);\n            let nodeTs = str.node.getComponent(str.name);\n            //初始化\n            if(nodeTs)nodeTs.init&&nodeTs.init(str.data);\n        }\n        \n\n    }\n\n    \n\n\n    // update (dt) {}\n}\n"]}