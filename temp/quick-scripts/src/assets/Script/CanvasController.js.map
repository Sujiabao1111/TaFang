{"version":3,"sources":["assets\\Script\\CanvasController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import btn from \"../prefab/tool/script/btn\";\nimport { AssistCtr } from \"./Assist/AssistCtr\";\nimport baseTs from \"./base/baseTs\";\nimport jsonSingleton from \"./base/jsonSingleton\";\nimport { AdPosition } from \"./common/AdPosition\";\nimport { propState } from \"./common/faceTs\";\nimport NameTs from \"./common/NameTs\";\nimport ModelTip from \"./model/ModelTip\";\nimport PageManage from \"./PageManage\";\nimport { UrlConst } from \"./server/UrlConst\";\nimport AdController from \"./server/xmsdk_cocos/AD/AdController\";\nimport { AppInfo } from \"./server/xmsdk_cocos/Config/AppInfo\";\nimport XMSDK from \"./server/xmsdk_cocos/XMSDK\";\nimport soundController from \"./soundController\";\nimport tool from \"./util/tool\";\nimport util from \"./util/util\";\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class CanvasController extends baseTs {\n\n\n    @property({ type: cc.Node, displayName: \"基础位置\" })\n    BaseBox: cc.Node = null;\n\n    @property({ type: cc.Node, displayName: \"Ui位置\" })\n    UiBox: cc.Node = null;\n\n    @property({ type: cc.Node, displayName: \"特效位置\" })\n    EffectBox: cc.Node = null;\n\n    @property({ type: cc.Node, displayName: \"弹窗位置\" })\n    PopBox: cc.Node = null;\n\n    @property({ type: cc.Node, displayName: \"toast弹窗\" })\n    modelTip: cc.Node = null;\n    \n    @property({ type: cc.Node, displayName: \"道具位置\" })\n    PropBox: cc.Node = null;\n    \n    @property({ type: cc.Node, displayName: \"加载页\" })\n    loadPage: cc.Node = null;\n    \n    @property({ type: cc.Node, displayName: \"网络失败\" })\n    noLine: cc.Node = null;\n\n\t @property({ type: cc.JsonAsset, displayName: \"关卡数据\" })\n\t mapdata: cc.JsonAsset = null;\n\t\n\n    private jinqule:boolean = false;\n//更-多-源-码-联-系-Q:30-387-459-55\n    onLoad() {\n\n        // cc.macro.CLEANUP_IMAGE_CACHE = false;\n        // cc.dynamicAtlasManager.enabled = true;\n        // cc.dynamicAtlasManager.showDebug(true);\n\n        cc.director.on(NameTs.Show_Toast, res => {\n            if (this.modelTip) {\n                let modelTipTs: ModelTip = this.modelTip.getComponent(ModelTip);\n                modelTipTs.showMessage(res);\n            }\n        },this);\n\n        cc.game.on(NameTs.Close_LoadPage,res=>{\n            this.loadPage.active = false;\n        },this);\n\n        XMSDK.initialize();\n\t\tutil.inidata()\n\t\tthis.loadingJson();\n\t\tjsonSingleton.singleton.jsonData[NameTs.gkData] = this.mapdata.json;\n        this.getAllLocalStorage();        \n\t\t\n\t\t\n\t\t\n\t\t\n\t\t util.userData.offlineIncome ={\n                        reward:0,\n                        multipleReward:0\n                    } \n\t\t\n\t\t\n\t\t\n\t\n\t\t\t\t\tlet dds = []\n                    dds.forEach(element => {\n                        util.userData.prop[element.propId - 1].num = element.propNum;\n                    });\n                    // util.userData.prop = res;\n                    console.log(dds, '用户背包');\n            \n\t\t\n\t\t//进度数据\n\t\t\t\t\tlet propdata = [{\"type\":\"1\",\"name\":\"冰冻\",\"explain\":\"冰冻怪物\\n10s\",\"time\":\"10\",\"level\":\"1\"},{\"type\":\"2\",\"name\":\"电击\",\"explain\":\"怪物接受额外伤害+20\",\"time\":\"3\",\"level\":\"1\"},{\"type\":\"3\",\"name\":\"护罩\",\"explain\":\"保护水晶塔\\n30s\",\"time\":\"30\",\"level\":\"25\"},{\"type\":\"4\",\"name\":\"清屏\",\"explain\":\"消灭所有怪兽\",\"time\":\"0\",\"level\":\"45\"},{\"type\":\"5\",\"name\":\"自动合成\",\"explain\":\"炮塔自动合成\\n30s\",\"time\":\"30\",\"level\":\"5\"},{\"type\":\"6\",\"name\":\"增能\",\"explain\":\"炮塔攻击力X2\\n20s\",\"time\":\"20\",\"level\":\"1\"}];\n\t\t\t\t\n\t\t\t\tlet  ab_test=[{\"lock_turret_test\":{\"A\":\"true\",\"B\":\"true\"}},{\"heaven_coin_test\":{\"A\":\"true\",\"B\":\"true\"}},{\"new_hand_test\":{\"A\":\"true\",\"B\":\"true\"}}]\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n                if(propdata){\n                    util.propConfig = propdata;\n                    //console.log(\"道具详细说明\",util.propConfig);\n                }\n\n               util.online_time = 10 * 60; \n                if(ab_test){\n                    let test = ab_test;\n                    for(let i = 0;i<test.length;i++){\n                        let key:string = Object.keys(test[i])[0];\n                        util.AB_Test[key] = test[i][key];\n                    }\n                }\n\n\t\t\t\t\n\t\t\t\t\t//初始化一些数据\n\t\t\t\t\tutil.userData.airborneCount = 15;\n                \n\n                    \n\n                    if (util.userData.noviceGuide == 1 && util.userData.newUser == true) {\n                        util.userData.product = 40;\n                    }\n\n                    if (util.userData.turretLevel > 1) {\n                        util.userData.noviceGuide = -1;\n                        util.setStorage(util.localDiary.noviceGuide, -1);\n                    }\n\t\t\t\t\tutil.behaviorRewardVoList =[{\"type\":1,\"reward\":50},{\"type\":2,\"reward\":4},{\"type\":4,\"reward\":75},{\"type\":5,\"reward\":50}];\n\t\t\t\t\t\n\n                    util.mapConfig = util.getMapdata(util.userData.customs.big);\n\n                 \t\t\n\t\t\t\t\tutil.propConfig=null\n\t\t\t\t\tthis.jinqule = true;\n                    util.iphoneXTop = XMSDK.getLiuHaiHeight();\n\t\t\n\t\t\n\n       \n\t\t\n\t\t\n\t\t\n\t\n        \n        \n      \n\n    }\n\n    /**\n     * 获取本地数据\n     */\n    getAllLocalStorage() {\n\n\n        for (let key in util.localDiary) {\n\n            let value = util.getStorage(key);\n            if (value) {\n                util.userData[key] = value;\n            }\n\n        }\n\n    }\n\n    start() {\n        XMSDK.finishCocosLaunch();\n        this.scheduleOnce(()=>{\n            if(!this.jinqule&&this.noLine){\n                this.noLine.active = true;\n            }\n        },30);\n    }\n\n    /**\n     * 加载json\n     */\n    loadingJson() {\n\n        jsonSingleton.singleton.loadJson(util.jsonArr, () => {\n            this.loadingPage();\n        });\n\n    }\n\n    /**\n     * 加载场景页面\n     */\n    loadingPage() {\n\n        this.loadAny(\"prefab/view/game\", cc.Prefab, (prefab) => {\n\n            let item: cc.Node = cc.instantiate(prefab);\n\n            item.setParent(this.BaseBox);\n\n        });\n\n        this.loadAny(\"prefab/view/ui\", cc.Prefab, (prefab) => {\n\n            let item: cc.Node = cc.instantiate(prefab);\n\n            item.setParent(this.UiBox);\n\n        });\n\n        // this.loadAny(\"prefab/view/propContent\", cc.Prefab, (prefab) => {\n        //     let item: cc.Node = cc.instantiate(prefab);\n\n        //     item.setParent(this.PropBox);\n\n        // });\n\n        //初始化弹窗\n        PageManage.singleton = new PageManage();\n        PageManage.singleton.parent = this.PopBox;\n\n\n        \n\n        if(soundController || !soundController.singleton){            \n            soundController.singleton = new soundController();\n        }\n\n        if (!cc.sys.isNative) { \n            soundController.isPlayMusic = true;\n            soundController.singleton.playBGM();\n        }\n    }\n\n\n    /**\n     * 拉去用户数据\n     * @param call 回调\n     */\n    initUser(call: Function) {\n        XMSDK.post({\n            url: UrlConst.gameInfoIndex,\n            onSuccess: res => {\n                let data = res.data;\n                let goldPoint = data.goldPoint;\n                \n                this.initUserData(call);\n            },\n            onFail: err => {\n                \n            }\n        });\n    }\n\n    initUserData(call: Function) {\n        XMSDK.getdataStr({\n            url: UrlConst.gameLevelIndex,\n            onSuccess: res => {\n                console.log(\"请求成功gameLevelIndex\", res)\n                if (res.code === 0 && res.data) {\n                    let data = res.data;\n                    let userGameMapSnapShotVO = data.userGameMapSnapShotVO;\n\n                    if (data.leftTime !== 0) {\n                        util.doubleEarn.use = propState.start;\n                        util.doubleEarn.time = Number(data.leftTime);\n                    }\n\n                    //util.userData.customs.big = data.level + 1;\n\n                    util.userData.newUser = userGameMapSnapShotVO.newUser;\n                    util.userData.turretLevel = userGameMapSnapShotVO.userBatteryDTO.highestLevel;\n\n                    if (userGameMapSnapShotVO.userMapDetail == null) {\n                        util.initPool();\n                    } else {\n                        util.userData.pool = userGameMapSnapShotVO.userMapDetail;\n                        util.repairPool();\n                    }\n\n                   /* util.userData.product = userGameMapSnapShotVO.userBatteryDTO.num;\n\n                    if (util.userData.noviceGuide == 1 && util.userData.newUser == true) {\n                        util.userData.product = 40;\n                    }*/\n\n                    if (util.userData.turretLevel > 1) {\n                        util.userData.noviceGuide = -1;\n                        util.setStorage(util.localDiary.noviceGuide, -1);\n                    }\n\n                    util.behaviorRewardVoList = data.behaviorRewardVoList;\n                    util.mapConfig = data.mapConfig;\n\n                    \n                    // util.userData.customs.small = util.mapConfig.length-1;\n\n                    // util.gameLevelPassRewardVoList.push({\n                    //     rewardType: 2,\n                    //     rewardValue: tool.GetArrData(\"type\", 4, data.behaviorRewardVoList).reward\n                    // });\n                    // util.gameLevelPassRewardVoList = tool.GetArrData(\"type\", 4, data.behaviorRewardVoList).reward;\n\n                    util.userData.version = userGameMapSnapShotVO.version;\n\n                    console.log(util.userData, ' userData');\n                    call && call();\n                }\n                else {\n\n                }\n            },\n            onFail: err => {\n\n            }\n        });\n\n        \n        \n\n        \n    }\n    /**\n     * 重新加载场景\n     */\n    AgainScene(){\n\n        cc.director.loadScene(\"game\");\n\n    }\n\n    // update (dt) {}\n}\n"]}